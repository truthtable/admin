import{r as l,j as e,a as le}from"./react-372c844c.js";import{c as Lr}from"./react-dom-b6dd4775.js";import{L as ve,H as Kt}from"./react-router-dom-b138b015.js";import{B as Qt,a as Fr,b as Ur,c as Gr,d as Pr,F as Or,e as Wr,f as Mr,g as $r,h as Br,i as qr,j as Hr,k as Kr,R as Qr,l as Ss,T as Vr,m as Cs,C as Vt,n as zr,o as Yr,p as zt,q as vs,r as Jr,s as Xr,M as Es,I as at,t as ft,u as Zr,v as ea,w as Yt,x as ta,y as sa,z as ra,A as aa,D as na,E as oa,G as la,H as ia,J as ca,K as da,L as ua}from"./react-icons-616ad79a.js";import{u as pe,a as J,P as ha}from"./react-redux-a58e67e4.js";import{c as je,a as xe,b as ma}from"./@reduxjs-1a2eb168.js";import{a as Gt}from"./axios-b5ee139b.js";import{B as A,C as Se,L as fe,T as ye,a as $,M as Ne,S as me,b as ke,c as ue,D as B,I as G,d as C,e as _e,f as _s,g as ge,h as pa,i as ct,j as We,k as we,l as be,F as Be,m as Fe,n as Te,O as Re,o as It,p as Ds,q as Jt,r as Ke,A as xa,s as ga,t as Xt,R as fa,u as Zt,v as es,w as ya}from"./@mui-dce3b57d.js";import{b as ja,d as ts,e as de}from"./react-router-01078d67.js";import{P as ss}from"./prop-types-aac2bd19.js";import"./firebase-e89386df.js";import{i as wa,g as ba,a as Sa,c as Ns,b as Ca,d as va,e as rs,f as Ea,s as _a,h as as,o as Da}from"./@firebase-61732f2e.js";import{l as ks}from"./react-to-print-2ca10ef7.js";import"./html2canvas-873d66f2.js";import"./jspdf-f6b06e03.js";import{h as Na}from"./html2pdf.js-b91f0a84.js";import{C as ka}from"./react-csv-7a92c50b.js";import"./@babel-ea433da3.js";import"./@remix-run-e054197a.js";import"./use-sync-external-store-93c060b9.js";import"./redux-ea15d17b.js";import"./immer-5499f661.js";import"./redux-thunk-f771c803.js";import"./@emotion-f543e787.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./stylis-79144faa.js";import"./clsx-0839fdbe.js";import"./@popperjs-61ffd834.js";import"./idb-81bdbf9b.js";import"./fflate-7e11f8f1.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const K="https://srdgas.online/",Ts=K+"api/token",Ta=K+"api/check",Ra=K+"api/customer_data",Ia=K+"api/count",Aa=K+"api/delivery_history?start=0&end=500",ns=K+"api/courier_boy_info",nt=K+"api/gas_cylinder_data",La=K+"api/deleteGasDeliverys/",Fa=K+"api/insertGasDeliverys",Ua=K+"api/search",Ga=K+"api/delivery_update/",Pa=K+"api/update_cylinder/",Rs=K+"api/update_customer/",yt=K+"api/update_user/",Oa=K+"api/customer_payments_update_or_create",Wa=()=>{let t=null;try{document.cookie.split(";").forEach(a=>{let n=a.trim().split("=");const o=n[0],i=n[1];t={...t,[o]:i}}),(t.token===void 0||t.token==="")&&(t=null)}catch(s){console.warn(s)}return t},jt=Gt.create({baseURL:K+"api/"}),ee=()=>(jt.interceptors.request.use(t=>{const s=sessionStorage.getItem("otpToken"),r=sessionStorage.getItem("authToken");let a=null;return s&&(a=s),r&&(a=r),a&&(t.headers.Authorization=`Bearer ${a}`),t},t=>Promise.reject(t)),jt.interceptors.response.use(t=>t,t=>(t.response&&t.response.status===401&&(sessionStorage.removeItem("authToken"),sessionStorage.removeItem("otpToken"),window.location.reload()),Promise.reject(t))),jt);ee();const ot=je("count/fetchCount",async(t,{getState:s})=>{let r=!0,a={today_delivery:0,courier_boy_count:0,customer_count:0,gas_count:0},n="";const o=sessionStorage.getItem("authToken");try{a=await(await fetch(Ia,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420",Authorization:`Bearer ${o}`})})).json(),r=!1}catch(i){console.warn(i),r=!0,n=i.message}return{data:a,error:r,errorMessage:n}}),Ma=xe({name:"count",initialState:{isLoading:!1,data:{today_delivery:0,courier_boy_count:0,customer_count:0,gas_count:0},isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(ot.pending,(s,r)=>{s.isLoading=!0,s.isError=!1,s.errorMessage=""}),t.addCase(ot.fulfilled,(s,r)=>{s.isLoading=!1,s.data=r.payload.data,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage}),t.addCase(ot.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),$a=Ma.reducer;function Ba(){let t={},s=!1;const r=pe(),a=J(i=>i.count),n=J(i=>i.login);t=a.data,s=a.isLoading,l.useEffect(()=>{n.token!==null&&r(ot())},[]);const o=s?"block":"none";return e.jsxs(A,{sx:{color:"white",overflow:"auto",height:"100%",pr:2},children:[e.jsx("div",{className:"main-title",children:e.jsx("h3",{style:{color:"white"},children:"Admin Dashboard"})}),e.jsxs("div",{className:"main-cards",children:[e.jsxs(ve,{to:"/admin/purchase",className:"link shadow-lg",children:[e.jsxs("div",{className:"card-inner",children:[e.jsx("h3",{children:"Purchase"}),e.jsx(Qt,{className:"card_icon"})]}),e.jsxs("div",{children:[e.jsx(Se,{sx:{display:o},color:"primary",variant:"soft"}),e.jsx("span",{style:{display:s?"none":"block"},children:10})]})]}),e.jsxs(ve,{to:"/admin/readWherehouse",className:"link shadow-lg",children:[e.jsxs("div",{className:"card-inner",children:[e.jsx("h3",{children:"Wherehouse"}),e.jsx(Qt,{className:"card_icon"})]}),e.jsxs("div",{children:[e.jsx(Se,{sx:{display:o},color:"primary",variant:"soft"}),e.jsx("span",{style:{display:s?"none":"block"},children:10})]})]}),e.jsxs(ve,{to:"/admin/deliveryHistory",className:"link shadow-lg",children:[e.jsxs("div",{className:"card-inner",children:[e.jsx("h3",{children:"Delivery History"}),e.jsx(Fr,{className:"card_icon"})]}),e.jsxs("div",{children:[e.jsx(Se,{sx:{display:o},color:"primary",variant:"soft"}),e.jsx("span",{style:{display:s?"none":"block"},children:t.today_delivery})]})]}),e.jsxs(ve,{to:"/admin/ViewCustomer",className:"link shadow-lg",children:[e.jsxs("div",{className:"card-inner",children:[e.jsx("h3",{children:"Customers"}),e.jsx(Ur,{className:"card_icon"})]}),e.jsxs("div",{children:[e.jsx(Se,{sx:{display:o},color:"primary",variant:"soft"}),e.jsx("span",{style:{display:s?"none":"block"},children:t.customer_count})]})]}),e.jsxs(ve,{to:"/admin/readDeliveryBoy",className:"link shadow-lg",children:[e.jsxs("div",{className:"card-inner",children:[e.jsx("h3",{children:"Delivery Boy"}),e.jsx(Gr,{className:"card_icon"})]}),e.jsxs("div",{children:[e.jsx(Se,{sx:{display:o},color:"primary",variant:"soft"}),e.jsx("span",{style:{display:s?"none":"block"},children:t.courier_boy_count})]})]}),e.jsxs(ve,{to:"/admin/report",className:"link shadow-lg",children:[e.jsxs("div",{className:"card-inner",children:[e.jsx("h3",{children:"Bills & Report"}),e.jsx(Pr,{className:"card_icon"})]}),e.jsxs("div",{children:[e.jsx(Se,{sx:{display:o},color:"primary",variant:"soft"}),e.jsx("span",{style:{display:s?"none":"block"},children:0})]})]})]})]})}function qa({openSidebarToggle:t,OpenSidebar:s}){const[r,a]=l.useState(!0);return e.jsx("aside",{id:"sidebar",className:t?"sidebar-responsive":"",onMouseEnter:()=>{a(!1)},onMouseLeave:()=>{a(!0)},style:{},children:e.jsx("ul",{className:"sidebar-list",children:[{label:"Dashboard",path:"/admin/",icon:e.jsx(Or,{className:"icon"})},{label:"Purchase",path:"/admin/purchase",icon:e.jsx(Wr,{className:"icon"})},{label:"Warehouse",path:"/admin/readWherehouse",icon:e.jsx(Mr,{className:"icon"})},{label:"Deliveries",path:"/admin/deliveryHistory",icon:e.jsx($r,{className:"icon"})},{label:"Customers",path:"/admin/ViewCustomer",icon:e.jsx(Br,{className:"icon"})},{label:"Delivery Boys",path:"/admin/readDeliveryBoy",icon:e.jsx(qr,{className:"icon"})},{label:"Bills & Reports",path:"/admin/report",icon:e.jsx(Hr,{className:"icon"})}].map((n,o)=>e.jsx(ve,{to:n.path,children:e.jsxs("li",{className:"sidebar-list-item",children:[n.icon,e.jsx(A,{sx:{marginLeft:"10px",wordBreak:"keep-all",transition:"all 0.3s ease-in-out",width:r?"0px":"100px",opacity:r?"0":"1"},children:n.label})]})},o))})})}function Ha({OpenSidebar:t}){return e.jsx("div",{className:"header",style:{justifyContent:" space-between"},children:e.jsx(Kr,{size:50,onClick:t})})}const De=je("gas/fetchGasData",async()=>{let t=!0,s=null,r=!1;try{const a=sessionStorage.getItem("authToken");s=await(await fetch(nt,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420",Authorization:`Bearer ${a}`})})).json(),t=!1}catch(a){console.warn(a),t=!0,r=a.message}return{data:s,error:t,errorMessage:r}}),Ka=xe({name:"gas",initialState:{isLoading:!1,data:null,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(De.pending,(s,r)=>{s.isLoading=!0,s.isError=!1}),t.addCase(De.fulfilled,(s,r)=>{s.isLoading=!1,s.data=r.payload.data,s.isError=!1,s.errorMessage=r.payload.errorMessage}),t.addCase(De.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),Qa=Ka.reducer,wt=je("customer/fetchCustomerSearchData",async t=>{let s=!0,r=[],a="";if(t.trim()==="")return s=!1,{data:r,error:s,errorMessage:a};try{const n=sessionStorage.getItem("authToken");r=(await(await fetch(Ua+"?name="+t,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420",Authorization:`Bearer ${n}`})})).json()).data,s=!1}catch(n){console.warn(n),s=!0,a=n.message}return{data:r,error:s,errorMessage:a}}),Va=xe({name:"search_customer",initialState:{isLoading:!1,data:[],isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(wt.pending,(s,r)=>{s.isLoading=!0}),t.addCase(wt.fulfilled,(s,r)=>{s.isLoading=!1,s.data=r.payload.data,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage}),t.addCase(wt.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),za=Va.reducer,bt=je("gas/updateGas",async t=>{let s=!1,r=!0,a="",n=Pt({price:t.price});console.log(n);try{const o=sessionStorage.getItem("authToken"),m=await(await fetch(Pa+t.id,{method:"put",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${o}`}),body:n})).json();s=m.result,console.log(m),r=!1}catch(o){console.warn(o),r=!0,a=o.message}return{isSuccessful:s,error:r,errorMessage:a}}),Ya=xe({name:"updateGas",initialState:{isSuccessful:!1,isLoading:!1,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(bt.pending,(s,r)=>{s.isLoading=!0}),t.addCase(bt.fulfilled,(s,r)=>{s.isLoading=!1,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage,s.isSuccessful=r.payload.isSuccessful}),t.addCase(bt.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),Ja=Ya.reducer,Pt=t=>Object.keys(t).map(function(r){return encodeURIComponent(r)+"="+encodeURIComponent(t[r])}).join("&"),St=je("delivery/updateDelivery",async t=>{let s=!1,r=!0,a="";if(t.reset)return r=!1,{isSuccessful:s,error:r,errorMessage:a};try{const n=sessionStorage.getItem("authToken");s=(await(await fetch(Ga+t.id,{method:"put",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${n}`}),body:Pt(t.data)})).json()).isSuccessful,r=!1}catch(n){console.warn(n),r=!0,a=n.message}return{isSuccessful:s,error:r,errorMessage:a}}),Xa=xe({name:"updateDelivery",initialState:{isSuccessful:!1,isLoading:!1,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(St.pending,(s,r)=>{s.isLoading=!0}),t.addCase(St.fulfilled,(s,r)=>{s.isLoading=!1,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage,s.isSuccessful=r.payload.isSuccessful}),t.addCase(St.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),Za=Xa.reducer,Ee=je("data/fetchGetData",async t=>{let s=!0,r=null,a="";const n=t+"?"+new URLSearchParams({startDate:sn(),endDate:rn()}).toString();console.log(n);try{const o=sessionStorage.getItem("authToken"),i=await fetch(n,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420",Authorization:`Bearer ${o}`})});r=await i.json();const m=i.headers.get("X-Log-Data"),S=decodeURIComponent(m);console.log(S),s=!1}catch(o){console.warn(o),s=!0,a=o.message,console.error(a)}return{data:r,error:s,errorMessage:a,url:t}}),en=xe({name:"getData",initialState:{data:null,isLoading:!1,isError:!1,errorMessage:"",url:""},extraReducers:t=>{t.addCase(Ee.pending,(s,r)=>{s.isLoading=!0}),t.addCase(Ee.fulfilled,(s,r)=>{s.isLoading=!1,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage,s.data=r.payload.data,s.url=r.payload.url}),t.addCase(Ee.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),tn=en.reducer,sn=()=>{const t=new Date(new Date().getFullYear(),new Date().getMonth(),1),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${s}-${r}-${a}`},rn=()=>{const t=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${s}-${r}-${a}`};function an(t){const{thead:s,tbody:r,loading:a}=t;return e.jsxs("div",{style:{width:"100%",flexGrow:1},children:[e.jsx("div",{style:{display:a?"block":"none"},children:e.jsx(fe,{color:"primary",variant:"soft"})}),e.jsxs(ye,{"aria-label":"striped table",stripe:"odd",sx:{tableLayout:"auto!important"},children:[e.jsx("thead",{children:e.jsx("tr",{children:s.map((n,o)=>e.jsx("th",{style:{padding:"0px",margin:"0px"},children:n},o))})}),e.jsx("tbody",{children:r.map((n,o)=>e.jsx("tr",{style:{backgroundColor:o%2===0?"#ffffff":"#f0f0f2"},children:n.map((i,m)=>e.jsx("td",{style:{padding:"0px",margin:"0px"},children:i},m))},o))})]})]})}function Ue(t){const{children:s}=t;return e.jsx(A,{sx:{padding:"0px",margin:"0px",backgroundColor:"transparent",mx:"8px"},children:e.jsx($,{style:{flexGrow:1,width:"100%",height:"100%",margin:"0px",padding:"0px",borderRadius:"0px",color:"black",backgroundColor:"transparent",whiteSpace:"nowrap",disabled:!0},children:s})})}const Ge=je("customer/updateCustomer",async t=>{let s=!1,r=!0,a="";if(t.reset)return r=!1,console.log("reset"),{isSuccessful:s,error:r,errorMessage:a};try{const n=sessionStorage.getItem("authToken"),i=await(await fetch(t.url,{method:"put",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${n}`}),body:Pt(t.data)})).json();s=i.isSuccesfull,console.log(i,s),r=!1}catch(n){console.warn(n),r=!0,a=n.message}return{isSuccessful:s,error:r,errorMessage:a}}),nn=xe({name:"updateCustomer",initialState:{isSuccessful:!1,isLoading:!1,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(Ge.pending,(s,r)=>{s.isLoading=!0}),t.addCase(Ge.fulfilled,(s,r)=>{s.isLoading=!1,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage,s.isSuccessful=r.payload.isSuccessful}),t.addCase(Ge.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),on=nn.reducer,Is=t=>!(t===null||t.length===0),os="text",Qe="number";function qe({userId:t,custId:s,text:r,type:a,name:n,value:o,updateUser:i,table:m}){const S=n.charAt(0).toUpperCase()+n.slice(1).replace("_"," ");let v=o,c=o;const[E,_]=l.useState(!1),x=pe(),d=J(L=>L.updateCustomer),u=()=>{let L=!0;const T=Number(t),F=Number(s),p=a===Qe?Number(v):v;if(E&&(a==Qe&&(/^[0-9]*$/.test(p)||(L=!1,alert("Invalid Number"))),L&&Is(m))){let O=`${m}${i?T:F}`;x(Ge({url:O,data:{[n]:p}}))}};return l.useEffect(()=>{d.isSuccessful&&(x(Ge({reset:!0})),_(!1))},[d.isSuccessful]),e.jsxs(e.Fragment,{children:[e.jsx(A,{sx:{padding:"0px",margin:"0px",backgroundColor:"transparent",mx:"2px",transition:"background-color 0.3s","&:hover":{backgroundColor:"rgb(75 112 245 / 25%)"},pl:1},children:e.jsx($,{style:{flexGrow:1,width:"100%",height:"100%",margin:"0px",padding:"0px",borderRadius:"0px",color:"black",backgroundColor:"transparent",whiteSpace:"nowrap",textAlign:"left",disabled:!0,justifyContent:"flex-start"},onClick:()=>{_(!0)},children:r})}),e.jsx(Ne,{"aria-labelledby":"modal-title","aria-describedby":"modal-desc",open:E,onClose:()=>{x(Ge({reset:!0})),_(!1)},sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs(me,{variant:"outlined",sx:{maxWidth:500,borderRadius:"md",p:3,overflow:"auto",boxShadow:"lg",maxHeight:"100vh"},children:[e.jsx(ke,{variant:"plain",sx:{m:1}}),e.jsx(ue,{component:"h2",id:"modal-title",level:"h4",textColor:"inherit",fontWeight:"lg",children:"Change"}),e.jsx(B,{sx:{my:1}}),e.jsx(ue,{component:"span",textColor:"inherit",fontWeight:"lg",children:S}),e.jsx(fe,{sx:{display:d.isLoading?"block":"none",marginTop:"10px"}}),e.jsx(G,{variant:"soft",placeholder:r+"",type:a,defaultValue:c,sx:{marginTop:"10px"},onChange:L=>{v=L.target.value}}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px"},children:[e.jsx($,{variant:"soft",onClick:()=>{x(Ge({reset:!0})),_(!1)},children:"Cancel"}),e.jsx($,{variant:"solid",onClick:u,sx:{ml:1},children:"Save"})]})]})})]})}const ln=()=>{const t=pe(),s=J(n=>n.getData),r=J(n=>n.updateCustomer);console.log(s);let a=[];return s.data!==null&&s.data.data.length>0&&s.data.data.forEach(n=>{a.push([n.company_name,n.kg+" kg"])}),l.useEffect(()=>{(s.data==null||s.url!=nt)&&t(Ee(nt)),r.isSuccessful&&t(Ee(nt))}),e.jsxs("div",{style:{width:"100%",overflow:"auto",padding:"10px"},children:[e.jsx(C,{direction:"row",spacing:2,sx:{display:"flex",justifyContent:"end"},children:e.jsx($,{startDecorator:e.jsx(Qr,{}),children:"Add Gas"})}),e.jsxs(A,{sx:{display:"flex",justifyContent:"center",flexWrap:"wrap",gap:1,marginTop:1},children:[e.jsx(He,{name:"Go Gsa"}),e.jsx(He,{name:"Hp"}),e.jsx(He,{name:"Jio"}),e.jsx(He,{name:"Tata"})]})]})},He=({name:t,children:s})=>{He.propTypes={name:ss.string.isRequired,children:ss.node};const r=[1,2],[a,n]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(_e,{sx:{width:200,backgroundColor:ls(t.charAt(0)),color:"white",transition:"all 0.2s","&:hover":{cursor:"pointer",transform:"scale(1.05)",boxShadow:"0 0 10px rgba(0,0,0,0.3)"}},variant:"soft",onClick:()=>n(!0),children:e.jsxs(_s,{children:[e.jsx(ue,{variant:"h5",component:"h2",sx:{textAlign:"center",color:"white"},children:e.jsx("strong",{children:t})}),e.jsx(B,{sx:{backgroundColor:"white",marginBottom:1.5}}),e.jsx(A,{sx:{display:"flex",justifyContent:"center",flexWrap:"wrap",gap:1},children:r.map((o,i)=>e.jsx(ge,{size:"lg",variant:"soft",sx:{backgroundColor:"white",color:ls(t.charAt(0))},children:e.jsx("strong",{children:o+" kg"})},i))}),s]})}),e.jsx(Ne,{open:a,onClose:()=>n(!1),children:e.jsxs(pa,{variant:"outlined",children:[e.jsx(ke,{}),e.jsxs(ue,{children:[t," : Add or Remove Kg"]})]})})]})};function ls(t){const s=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548"],r=t.charCodeAt(0)%s.length;return s[r]}const cn="GET_PLANTS",As="GET_PLANTS_SUCCESS",Ls="GET_PLANTS_FAILURE",dn="GET_PLANTS_REQUEST",un="GET_PLANTS_INIT",At=()=>async t=>{t({type:dn});try{const s=await ee().get(K+"api/plants");t({type:As,payload:s.data})}catch(s){t({type:Ls,error:s})}},is=localStorage.getItem("userData");let dt=null;if(is){const t=JSON.parse(is),s=new Date(t.timeStamps);new Date().getDate()!==s.getDate()?localStorage.removeItem("userData"):dt=t.data}console.log(dt);const Fs=xe({name:"loginV2",initialState:{data:dt,isLoading:!1,isError:!1,errorMessage:"",checkLogin:!1,networkError:!1,updated:!1},reducers:{loginInial(t){t.data=dt,t.isLoading=!1,t.isError=!1,t.checkLogin=!1,t.networkError=!1},loginStart:t=>{t.isLoading=!0,t.isError=!1,t.checkLogin=!1,t.networkError=!1,t.updated=!1},loginSuccess:(t,s)=>{t.isLoading=!1,t.data=s.payload,t.checkLogin=!0,t.isError=!1,t.errorMessage="",t.networkError=!1,t.updated=!0},loginUpdatedReset:t=>{t.updated=!1},loginFailure:(t,s)=>{t.isLoading=!1,t.isError=!0,t.errorMessage=s.payload,t.checkLogin=!1,t.data=null,t.networkError=!1},networkError:(t,s)=>{t.isLoading=!1,t.isError=!0,t.errorMessage=s.payload,t.checkLogin=!1,t.data=null,t.networkError=!0},clearError:t=>{t.isLoading=!1,t.isError=!1,t.errorMessage="",t.checkLogin=!1,t.data=null,t.networkError=!1},logout:t=>{t.data=null,t.isLoading=!1,t.isError=!1,t.errorMessage="",t.checkLogin=!1,t.networkError=!1},otpVerified:t=>{t.isLoading=!1,t.isError=!1,t.errorMessage="",t.checkLogin=!1,t.networkError=!1}}}),{loginInial:Oe,loginStart:Ot,loginSuccess:Wt,loginFailure:lt,logout:Di,networkError:hn,clearError:mn,loginUpdatedReset:pn}=Fs.actions,xn=Ts,gn=(t,s)=>async r=>{r(Ot());try{if(sessionStorage.removeItem("otpToken"),sessionStorage.removeItem("authToken"),!t||!s)return r(lt("Username and Password are required"));const a=await ee().post(xn,{username:t,password:s});console.log(a.data),a.data?.loginStatus?(sessionStorage.setItem("otpToken",a.data.token),r(Wt(a.data))):r(lt(a.data?.message||"Login failed"))}catch(a){console.log(" login : "+a),a.code==="ERR_NETWORK"||a.message==="Network Error"?r(hn("Network connection failed. Please check your internet connection.")):r(lt(a.response?.data?.message||"Login failed"))}},fn=t=>async s=>{try{s(Ot());const r=await ee().post("verify-otp",{otp:t});console.log(r.data),r.data.success&&(sessionStorage.setItem("authToken",r.data.token),sessionStorage.removeItem("otpToken"),window.location.reload()),console.log(r)}catch(r){console.log("validateLogin : ",r),s(lt(r.response?.data?.message||"OTP failed"))}s(Wt(null))},Ct=t=>async s=>{s(Ot());try{const r=await ee().post(K+"api/updateLogin",t);console.log(r.data)}catch(r){console.error(r),alert(r.response.data.message)}s(Wt(null))},yn=Fs.reducer,ze="FETCH_ORDERS_REQUEST",Us="FETCH_ORDERS_SUCCESS",Ye="FETCH_ORDERS_FAILURE",Gs="CREATE_ORDER_SUCCESS",Ps="UPDATE_ORDER_SUCCESS",Os="DELETE_ORDER_SUCCESS",Ws="ORDER_INIT",jn=()=>async t=>{t({type:Ws})},ut=t=>async s=>{s({type:ze}),console.log("params",t);try{const r=await ee().get(K+"api/purchase-orders",{params:t});let a=r.headers["x-log-data"];a=decodeURIComponent(a),console.log("xlog : ",a),s({type:Us,payload:r.data})}catch(r){r.response.status===401&&s(Oe()),s({type:Ye,error:r})}},wn=t=>async s=>{s({type:ze});try{const r=await ee().post(K+"api/purchase-orders",t);s({type:Gs,payload:r.data})}catch(r){r.response.status===401&&s(Oe()),s({type:Ye,error:r})}},ht=(t,s)=>async r=>{r({type:ze});try{const a=await ee().put(K+`api/purchase-orders/${t}`,s);console.log(a.data),r({type:Ps,payload:a.data})}catch(a){a.response.status===401&&r(Oe()),r({type:Ye,error:a})}},bn=t=>async s=>{s({type:ze});try{await ee().delete(K+`api/purchase-orders/${t}`),s({type:Os,payload:t})}catch(r){r.response.status===401&&s(Oe()),s({type:Ye,error:r})}},Ms="FETCH_WAREHOUSES_REQUEST",$s="FETCH_WAREHOUSES_SUCCESS",Bs="FETCH_WAREHOUSES_FAILURE",Sn="CREATE_WAREHOUSE_REQUEST",Cn="CREATE_WAREHOUSE_SUCCESS",vn="CREATE_WAREHOUSE_FAILURE",En="UPDATE_WAREHOUSE_REQUEST",_n="UPDATE_WAREHOUSE_SUCCESS",Dn="UPDATE_WAREHOUSE_FAILURE",Nn="DELETE_WAREHOUSE_REQUEST",kn="DELETE_WAREHOUSE_SUCCESS",Tn="DELETE_WAREHOUSE_FAILURE",Rn=K+"api/warehouses",In=()=>async t=>{t({type:Ms});try{const s=await ee().get(Rn);t({type:$s,payload:s.data})}catch(s){t({type:Bs,error:s.message})}},An=()=>{const t=pe(),s=J(c=>c.gas),{warehouses:r,loading:a,error:n}=J(c=>c.warehouses);if(l.useEffect(()=>{t(In()),s.data===null&&t(De())},[]),s.data===null||r==null||r.length===0)return!a&&r.length===0?e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%"},children:e.jsx(ue,{variant:"h5",children:"No Data Available"})}):e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%"},children:e.jsx(Se,{})});let o=[],i=new Map,m=new Map;if(r===null)return e.jsx("span",{children:"Error"});r.forEach(c=>{c.is_empty!=1&&i.set(c.gas_cylinder_id,c.count)}),r.forEach(c=>{c.is_empty!=0&&m.set(c.gas_cylinder_id,c.count)}),s.data.data.forEach(c=>{let E=0,_=0;try{E=i.get(c.id),_=m.get(c.id)}catch{E=0,_=0}o.push({gasId:c.id,name:c.company_name,kg:c.kg,full_quantity:E,empty_quantity:_})}),o=o.filter(c=>c.empty_quantity!=null&&c.empty_quantity!=null&&c.empty_quantity!=0||c.full_quantity!=null&&c.full_quantity!=null&&c.full_quantity!=0),o=o.map(c=>({name:c.name,kg:c.kg,full_quantity:c.full_quantity==null||c.full_quantity==null?0:c.full_quantity,empty_quantity:c.empty_quantity==null||c.empty_quantity==null?0:c.empty_quantity}));let S=0,v=0;return o=o.map((c,E)=>(S+=c.full_quantity,v+=c.empty_quantity,e.jsxs("tr",{children:[e.jsx("td",{children:c.name}),e.jsxs("td",{children:[c.kg," KG"]}),e.jsx("td",{children:c.full_quantity}),e.jsx("td",{children:c.empty_quantity})]},E))),e.jsxs(C,{sx:{backgroundColor:"white",height:"100%",width:"100%",overflow:"auto",p:1,borderRadius:"lg"},direction:"column",alignContent:"flex-start",justifyContent:"flex-start",alignItems:"stretch",gap:1,children:[e.jsxs(C,{direction:"row",children:[e.jsx(_e,{sx:{p:1,m:1,backgroundColor:"#BDE8CA",fontWeight:"bold"},children:e.jsxs(C,{mx:1,direction:"row",alignContent:"center",justifyContent:"center",alignItems:"center",children:["Total Full : ",e.jsx(ge,{size:"lg",sx:{backgroundColor:"#0D7C66",color:"white",fontWeight:"bold"},children:S})]})}),e.jsx(_e,{sx:{p:1,m:1,backgroundColor:"#F1F3C2",fontWeight:"bold"},children:e.jsxs(C,{mx:1,direction:"row",alignContent:"center",justifyContent:"center",alignItems:"center",children:["Total Empty : ",e.jsx(ge,{size:"lg",sx:{backgroundColor:"#CD5C08",color:"white",fontWeight:"bold"},children:v})]})})]}),e.jsx(_e,{sx:{p:0,m:0},children:e.jsxs(ye,{sx:{fontWeight:"bold",tableLayout:"fixed"},children:[e.jsx("thead",{children:e.jsx("tr",{children:["Gas Name","KG","Full Quantity","Empty quantity"].map((c,E)=>e.jsx("th",{style:{color:"white",backgroundColor:"#16423C",fontWeight:"bold"},children:c},E))})}),e.jsx("tbody",{children:o})]})})]})};function Ln(){return e.jsxs("div",{style:{width:"100%",overflow:"auto",padding:"10px"},children:[e.jsxs(C,{direction:"row",gap:1,children:[e.jsx($,{children:"Customer"}),e.jsx($,{children:"Delivery Boy"}),e.jsx(B,{orientation:"horizontal",sx:{flexGrow:1,opacity:0}}),e.jsx(G,{placeholder:"Search",startDecorator:e.jsx(Ss,{})})]}),e.jsxs(C,{direction:"row",justifyContent:"flex-start",alignItems:"stretch",spacing:1,sx:{width:"100%",mt:1},children:[e.jsx(C,{sx:{backgroundColor:"#FFF5E1",borderRadius:10,padding:1},children:"Section #1"}),e.jsx(C,{sx:{flexGrow:1},children:"Section #2"})]})]})}const Fn={apiKey:"AIzaSyBiLr7NLX4cqwq5qRry7Ym7GIMAk8lGyrU",authDomain:"shriram-distributors.firebaseapp.com",databaseURL:"https://shriram-distributors-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"shriram-distributors",storageBucket:"shriram-distributors.appspot.com",messagingSenderId:"306107127071",appId:"1:306107127071:web:a1d614d56a90615b88cc2a"},qs=wa(Fn),mt=ba(qs),cs=Sa(qs),ds=Ns(mt,"gas_record");class Un{addGas=s=>Ca(ds,s);getAllGas=()=>va(ds);updatGas=()=>{const s=rs(mt,"gas_record",id);return s(s)};deleteGas=s=>{const r=rs(mt,"gas_record",s);return Ea(r)};notifyDataChange=()=>{_a(as(cs,"root/change/"),{change:"update",changeBy:"admin"})};listenDataChange=s=>{const r=as(cs,"root/change/");Da(r,a=>{s&&s()})}}const Je=new Un;function Gn(){const[t,s]=l.useState(""),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState({error:!1,msg:""});l.useEffect(()=>{const x=setTimeout(()=>{E({error:!1,msg:""})},3e3);return()=>clearTimeout(x)},[c]);const _=async x=>{if(x.preventDefault(),E({error:!1,msg:""}),t===""||r===""||i===""||n===""||S===""){E({error:!0,msg:"Please fill in all fields, including the warehouse selection"});return}const d=parseInt(i,10);if(isNaN(d)||d<=0){E({error:!0,msg:"Quantity must be a positive number"});return}try{for(let u=0;u<d;u++){const L={company:t,weight:r,price:n,warehouse:S};await Je.addGas(L)}E({error:!1,msg:`${d} data submitted successfully`})}catch(u){E({error:!0,msg:u.message})}s(""),a(""),o(""),m(""),v("")};return e.jsxs("div",{className:"form-container",children:[c.error?e.jsx("div",{className:"text-red-500",children:c.msg}):e.jsx("div",{className:"text-green-500",children:c.msg}),e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"warehouse",children:"Select WhereHouse:"}),e.jsxs("select",{name:"warehouse",id:"warehouse",value:S,onChange:x=>v(x.target.value),children:[e.jsx("option",{value:"",disabled:!0,children:"Select WhereHouse"}),e.jsx("option",{value:"A",children:"WhereHouse A"}),e.jsx("option",{value:"B",children:"WhereHouse B"}),e.jsx("option",{value:"C",children:"WhereHouse C"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"",children:"Company Name:"}),e.jsx("input",{type:"text",placeholder:"Enter Company Name",value:t,onChange:x=>s(x.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dropdown2",children:"Weight:"}),e.jsx("input",{type:"text",placeholder:"Enter Weight",value:r,onChange:x=>a(x.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dropdown2",children:"Price:"}),e.jsx("input",{type:"text",placeholder:"Enter Price",value:n,onChange:x=>o(x.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"quantity",children:"Quantity:"}),e.jsx("input",{type:"number",id:"quantity",name:"quantity",value:i,onChange:x=>m(x.target.value),placeholder:"Enter Quantity"})]}),e.jsx("button",{type:"",className:"form-btn-submit",children:"Submit"})]})]})}function Pn(){const[t,s]=l.useState(""),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState({error:!1,msg:""});l.useEffect(()=>{const x=setTimeout(()=>{E({error:!1,msg:""})},3e3);return()=>clearTimeout(x)},[c]);const _=async x=>{if(x.preventDefault(),E({error:!1,msg:""}),t===""||r===""||i===""||n===""||S===""){E({error:!0,msg:"Please fill in all fields, including the warehouse selection"});return}const d=parseInt(i,10);if(isNaN(d)||d<=0){E({error:!0,msg:"Quantity must be a positive number"});return}try{for(let u=0;u<d;u++){const L={company:t,weight:r,price:n,warehouse:S};await Je.addGas(L)}E({error:!1,msg:`${d} data submitted successfully`})}catch(u){E({error:!0,msg:u.message})}s(""),a(""),o(""),m(""),v("")};return e.jsxs("div",{className:"form-container",children:[c.error?e.jsx("div",{className:"text-red-500",children:c.msg}):e.jsx("div",{className:"text-green-500",children:c.msg}),e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"warehouse",children:"Select WhereHouse:"}),e.jsxs("select",{name:"warehouse",id:"warehouse",value:S,onChange:x=>v(x.target.value),children:[e.jsx("option",{value:"",disabled:!0,children:"Select WhereHouse"}),e.jsx("option",{value:"A",children:"WhereHouse A"}),e.jsx("option",{value:"B",children:"WhereHouse B"}),e.jsx("option",{value:"C",children:"WhereHouse C"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"",children:"Company Name:"}),e.jsx("input",{type:"text",placeholder:"Enter Company Name",value:t,onChange:x=>s(x.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dropdown2",children:"Weight:"}),e.jsx("input",{type:"text",placeholder:"Enter Weight",value:r,onChange:x=>a(x.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dropdown2",children:"Price:"}),e.jsx("input",{type:"text",placeholder:"Enter Price",value:n,onChange:x=>o(x.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"quantity",children:"Quantity:"}),e.jsx("input",{type:"number",id:"quantity",name:"quantity",value:i,onChange:x=>m(x.target.value),placeholder:"Enter Quantity"})]}),e.jsx("button",{type:"",className:"form-btn-submit",children:"Submit"})]})]})}Ns(mt,"deliveryboy_record");function On(){const[t,s]=l.useState({error:!1,msg:""}),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState(""),[_,x]=l.useState("");l.useEffect(()=>{const u=setTimeout(()=>{s({error:!1,msg:""})},3e3);return()=>clearTimeout(u)},[t]);const d=async u=>{if(u.preventDefault(),s({error:!1,msg:""}),r===""||n===""||i===""||S===""||c===""||_===""){s({error:!0,msg:"Please fill in all fields"}),setTimeout(()=>{s({error:!1,msg:""})},3e3);return}};return e.jsxs("div",{className:"form-container-deliveryBoy",children:[t.error?e.jsx("div",{className:"text-red-500",children:t.msg}):e.jsx("div",{className:"text-green-500",children:t.msg}),e.jsxs("form",{onSubmit:d,className:"flex flex-wrap justify-center",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",placeholder:"Delivery Boy Name",value:r,onChange:u=>a(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"age",children:"Age:"}),e.jsx("input",{type:"text",placeholder:"Age",value:n,onChange:u=>o(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone_number",children:"Phone Number:"}),e.jsx("input",{type:"text",placeholder:"Phone Number",value:i,onChange:u=>m(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"state",children:"State:"}),e.jsx("input",{type:"text",placeholder:"State",value:S,onChange:u=>v(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"city",children:"City:"}),e.jsx("input",{type:"text",placeholder:"City",value:c,onChange:u=>E(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Address:"}),e.jsx("input",{type:"text",placeholder:"Address",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Bank Account No:"}),e.jsx("input",{type:"text",placeholder:"Bank Account No",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"IFSC Code:"}),e.jsx("input",{type:"text",placeholder:"IFSC Code",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"AdharCrad No:"}),e.jsx("input",{type:"text",placeholder:"AdharCrad No",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full px-4 py-2",children:e.jsx("button",{type:"",className:"form-btn-submit w-full",children:"Submit"})})]})]})}function Wn(){const[t,s]=l.useState({error:!1,msg:""}),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState(""),[_,x]=l.useState("");l.useEffect(()=>{const u=setTimeout(()=>{s({error:!1,msg:""})},3e3);return()=>clearTimeout(u)},[t]);const d=async u=>{if(u.preventDefault(),s({error:!1,msg:""}),r===""||n===""||i===""||S===""||c===""||_===""){s({error:!0,msg:"Please fill in all fields"}),setTimeout(()=>{s({error:!1,msg:""})},3e3);return}};return e.jsxs("div",{className:"form-container-deliveryBoy",children:[t.error?e.jsx("div",{className:"text-red-500",children:t.msg}):e.jsx("div",{className:"text-green-500",children:t.msg}),e.jsxs("form",{onSubmit:d,className:"flex flex-wrap justify-center",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",placeholder:"Delivery Boy Name",value:r,onChange:u=>a(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"age",children:"Age:"}),e.jsx("input",{type:"text",placeholder:"Age",value:n,onChange:u=>o(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone_number",children:"Phone Number:"}),e.jsx("input",{type:"text",placeholder:"Phone Number",value:i,onChange:u=>m(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"state",children:"State:"}),e.jsx("input",{type:"text",placeholder:"State",value:S,onChange:u=>v(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"city",children:"City:"}),e.jsx("input",{type:"text",placeholder:"City",value:c,onChange:u=>E(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Address:"}),e.jsx("input",{type:"text",placeholder:"Address",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Bank Account No:"}),e.jsx("input",{type:"text",placeholder:"Bank Account No",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"IFSC Code:"}),e.jsx("input",{type:"text",placeholder:"IFSC Code",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-0 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"AdharCrad No:"}),e.jsx("input",{type:"text",placeholder:"AdharCrad No",value:_,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full px-4 py-2",children:e.jsx("button",{type:"",className:"form-btn-submit w-full",children:"Submit"})})]})]})}function Mn(){const[t,s]=l.useState({error:!1,msg:""}),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState(""),[_,x]=l.useState(""),[d,u]=l.useState(""),[L,T]=l.useState("");l.useEffect(()=>{const p=setTimeout(()=>{s({error:!1,msg:""})},3e3);return()=>clearTimeout(p)},[t]);const F=async p=>{if(p.preventDefault(),s({error:!1,msg:""}),r===""||age===""||phone_number===""||S===""||i===""||address===""){s({error:!0,msg:"Please fill in all fields"}),setTimeout(()=>{s({error:!1,msg:""})},3e3);return}};return e.jsxs("div",{className:`mx-auto p-7 h-[34em] w-[70em] bg-white border border-gray-300 shadow-lg rounded-lg relative top-16
    form-container-wherehouse`,children:[t.error?e.jsx("div",{className:"text-red-500",children:t.msg}):e.jsx("div",{className:"text-green-500",children:t.msg}),e.jsxs("form",{onSubmit:F,className:"flex flex-wrap",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",placeholder:"Wherehouse Name",value:r,onChange:p=>a(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Supplier Name:"}),e.jsx("input",{type:"text",placeholder:"Supplier Name",value:_,onChange:p=>x(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"age",children:"Area:"}),e.jsx("input",{type:"text",placeholder:"Age",value:n,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone_number",children:"City:"}),e.jsx("input",{type:"text",placeholder:"City",value:i,onChange:p=>m(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"state",children:"State:"}),e.jsx("input",{type:"text",placeholder:"State",value:S,onChange:p=>v(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"city",children:"Country:"}),e.jsx("input",{type:"text",placeholder:"Country",value:c,onChange:p=>E(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Pin Code:"}),e.jsx("input",{type:"text",placeholder:"Pin Code",value:d,onChange:p=>u(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Date & Time:"}),e.jsx("input",{type:"datetime-local",placeholder:"Pin Code",value:L,onChange:p=>T(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full px-4 py-2",children:e.jsx("button",{type:"",className:"form-btn-submit w-full",children:"Submit"})})]})]})}function $n(){const[t,s]=l.useState({error:!1,msg:""}),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState(""),[_,x]=l.useState(""),[d,u]=l.useState(""),[L,T]=l.useState("");l.useEffect(()=>{const p=setTimeout(()=>{s({error:!1,msg:""})},3e3);return()=>clearTimeout(p)},[t]);const F=async p=>{if(p.preventDefault(),s({error:!1,msg:""}),r===""||age===""||phone_number===""||S===""||i===""||address===""){s({error:!0,msg:"Please fill in all fields"}),setTimeout(()=>{s({error:!1,msg:""})},3e3);return}};return e.jsxs("div",{className:`mx-auto p-7 h-[34em] w-[70em] bg-white border border-gray-300 shadow-lg rounded-lg relative top-16
      form-container-wherehouse-update`,children:[e.jsx("h1",{className:"text-lg leading-8 text-blue-800 font-bold mb-2 text-center",children:"Update Wherehouse Details"}),t.error?e.jsx("div",{className:"text-red-500",children:t.msg}):e.jsx("div",{className:"text-green-500",children:t.msg}),e.jsxs("form",{onSubmit:F,className:"flex flex-wrap",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",placeholder:"Wherehouse Name",value:r,onChange:p=>a(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Supplier Name:"}),e.jsx("input",{type:"text",placeholder:"Supplier Name",value:_,onChange:p=>x(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"age",children:"Area:"}),e.jsx("input",{type:"text",placeholder:"Age",value:n,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone_number",children:"City:"}),e.jsx("input",{type:"text",placeholder:"City",value:i,onChange:p=>m(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"state",children:"State:"}),e.jsx("input",{type:"text",placeholder:"State",value:S,onChange:p=>v(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"city",children:"Country:"}),e.jsx("input",{type:"text",placeholder:"Country",value:c,onChange:p=>E(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Pin Code:"}),e.jsx("input",{type:"text",placeholder:"Pin Code",value:d,onChange:p=>u(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Date & Time:"}),e.jsx("input",{type:"datetime-local",placeholder:"Pin Code",value:L,onChange:p=>T(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full px-4 py-2",children:e.jsx("button",{type:"",className:"form-btn-submit w-full",children:"Submit"})})]})]})}function Bn(){const[t,s]=l.useState({error:!1,msg:""}),[r,a]=l.useState(""),[n,o]=l.useState(""),[i,m]=l.useState(""),[S,v]=l.useState(""),[c,E]=l.useState(""),[_,x]=l.useState(""),[d,u]=l.useState(""),[L,T]=l.useState("");l.useEffect(()=>{const p=setTimeout(()=>{s({error:!1,msg:""})},3e3);return()=>clearTimeout(p)},[t]);const F=async p=>{if(p.preventDefault(),s({error:!1,msg:""}),name===""||age===""||phone_number===""||state===""||city===""||address===""){s({error:!0,msg:"Please fill in all fields"}),setTimeout(()=>{s({error:!1,msg:""})},3e3);return}};return e.jsxs("div",{className:`mx-auto p-7 h-[34em] w-[70em] bg-white border border-gray-300 shadow-lg rounded-lg relative top-16
      form-container-wherehouse-update`,children:[t.error?e.jsx("div",{className:"text-red-500",children:t.msg}):e.jsx("div",{className:"text-green-500",children:t.msg}),e.jsxs("form",{onSubmit:F,className:"flex flex-wrap",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Courier Boy Name:"}),e.jsx("input",{type:"text",placeholder:"Wherehouse Name",value:r,onChange:p=>a(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Customer Name:"}),e.jsx("input",{type:"text",placeholder:"Customer Name",value:n,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"age",children:"Address:"}),e.jsx("input",{type:"text",placeholder:"Address",value:i,onChange:p=>m(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone_number",children:"Gas Cylinder Company:"}),e.jsx("input",{type:"text",placeholder:"Gas Cylinder Company",value:S,onChange:p=>v(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"state",children:"Gas kg:"}),e.jsx("input",{type:"text",placeholder:"Gas kg",value:c,onChange:p=>E(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Date & Time:"}),e.jsx("input",{type:"datetime-local",placeholder:"Pin Code",value:_,onChange:p=>x(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"city",children:"Gas Price:"}),e.jsx("input",{type:"text",placeholder:"Gas Price",value:d,onChange:p=>u(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Recived Amount:"}),e.jsx("input",{type:"text",placeholder:"Recived Amount",value:L,onChange:p=>T(p.target.value),className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full px-4 py-2",children:e.jsx("button",{type:"",className:"form-btn-submit w-full",children:"Submit"})})]})]})}const qn=()=>e.jsx("h1",{children:"update Report"});function Hn(){return e.jsx("div",{className:"form-container-deliveryBoy",children:e.jsxs("form",{className:"flex flex-wrap justify-center",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",placeholder:"Delivery Boy Name",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"age",children:"Age:"}),e.jsx("input",{type:"text",placeholder:"Age",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone_number",children:"Phone Number:"}),e.jsx("input",{type:"text",placeholder:"Phone Number",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"state",children:"State:"}),e.jsx("input",{type:"text",placeholder:"State",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"city",children:"City:"}),e.jsx("input",{type:"text",placeholder:"City",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Address:"}),e.jsx("input",{type:"text",placeholder:"Address",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"Bank Account No:"}),e.jsx("input",{type:"text",placeholder:"Bank Account No",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"IFSC Code:"}),e.jsx("input",{type:"text",placeholder:"IFSC Code",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/3 sm:p-0 md:p-2 lg:p-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"AdharCrad No:"}),e.jsx("input",{type:"text",placeholder:"AdharCrad No",className:"w-full px-3 py-2 border rounded-md"})]})}),e.jsx("div",{className:"px-4 py-2",children:e.jsx("button",{type:"",className:"text-2xl form-btn-submit w-full",children:"Print"})})]})})}const Kn="DELIVERIES_INIT_STATE",Mt="FETCH_DELIVERIES_REQUEST",Hs="FETCH_DELIVERIES_SUCCESS",Ks="FETCH_DELIVERIES_FAILURE",Qs="UPDATE_DELIVERY_SUCCESS",Vs="UPDATE_DELIVERY_SUCCESS_RESET",zs="DELETE_DELIVERY",Ys="DELETE_DELIVERY_SUCCESS",Qn=()=>({type:Mt}),Vn=t=>({type:Hs,payload:t}),Ve=t=>({type:Ks,payload:t}),zn=()=>({type:Mt}),Yn=t=>({type:Qs,payload:t}),Jn=()=>({type:zs}),Xn=t=>({type:Ys,payload:t}),$t=K+"api/delivery",Zn=K+"api/gasDeliverys",us=t=>async s=>{s(Qn()),console.log(t);try{const a=(await ee().get($t,{params:t})).data;s(Vn(a))}catch(r){console.log("error",r),s(Ve(r.message))}},Js=t=>(console.log("req",t),async s=>{s(zn());try{let r;t.columnName!=null&&(t.columnName=="quantity"||t.columnName=="price")?r=await ee().put(`${Zn}/${t.id}`,t):r=await ee().put(`${$t}/${t.id}`,t);const a=r.data;a.success==!1?s(Ve(a.message)):s(Yn(a))}catch(r){console.log("error",r),s(Ve(r.message))}}),Xs=t=>{if(console.log("deleteDeliveryById : ",t),t!=null)return async s=>{try{s(Jn());let r=await ee().delete(`${$t}/${t}`);console.log("res",r.data);const a=r.data;a.success==!1?s(Ve(a.message)):s(Xn(t))}catch(r){s(Ve(r.message))}}},Zs="FETCH_USER_REQUEST",er="FETCH_USER_SUCCESS",tr="FETCH_USER_FAILURE",eo=()=>({type:Zs}),to=t=>({type:er,payload:t}),so=t=>({type:tr,payload:t}),ro=K+"api/userData",ao=()=>async t=>{t(eo());try{const r=(await ee().get(ro)).data;t(to(r))}catch(s){t(so(s.message))}},no="INI_GAS_DELIVERIES",oo="GET_GAS_DELIVERIES",sr="ADD_GAS_DELIVERY",rr="UPDATE_GAS_DELIVERY",ar="DELETE_GAS_DELIVERY",Xe="GAS_DELIVERY_ERROR",Ze="LOADING",nr="UPDATE_CREATE_DELETE",or="UPDATE_GAS_DELIVERY_SUCCESS_RESET",lo=t=>async s=>{if(console.log("adding gas delivery"),t.length!==0){s({type:Ze});try{const r=await ee().post(K+"api/gasDeliverys",{deliveries:t});console.log(r),s({type:sr})}catch{s({type:Xe})}}},io=t=>async s=>{if(t.length!==0){s({type:Ze});try{const r=await ee().put(K+"api/gasDeliverys/0",{deliveries:t});console.log(r),s({type:rr})}catch{s({type:Xe})}}},co=t=>async s=>{if(console.log("deleting gas delivery"),t.length!==0){s({type:Ze});try{const r=await ee().delete(K+"api/gasDeliverys/0",{headers:{"Content-Type":"application/json"},data:{ids:t}});console.log(r),s({type:ar})}catch{s({type:Xe})}}},uo=t=>async s=>{console.log("updateCreateDelete : ",t),s({type:Ze});try{const r=await ee().post(K+"api/updateOrCreateOrDelete",{data:t});console.log(r.data),s({type:nr})}catch{s({type:Xe})}},Pe=je("customer/fetchCustomerData",async()=>{let t=!0,s=null,r="";try{const a=sessionStorage.getItem("authToken");s=await(await fetch(Ra+"?isAdmin="+!0,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420",Authorization:`Bearer ${a}`})})).json(),t=!1}catch(a){console.warn(a),t=!0,r=a.message}return{data:s,error:t,errorMessage:r}}),ho=xe({name:"customer",initialState:{isLoading:!1,data:null,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(Pe.pending,(s,r)=>{s.isLoading=!0}),t.addCase(Pe.fulfilled,(s,r)=>{s.isLoading=!1,s.data=r.payload.data,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage}),t.addCase(Pe.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),mo=ho.reducer,lr="FETCH_GAS_REQUEST",ir="FETCH_GAS_SUCCESS",cr="FETCH_GAS_FAILURE",po="GAS_INI",xo=()=>({type:lr}),go=t=>({type:ir,payload:t}),fo=t=>({type:cr,payload:t}),yo=K+"api/gas",jo=()=>async t=>{t(xo());try{const s=await ee().get(yo);t(go(s.data))}catch(s){t(fo(s))}},hs=(t,s,r,a)=>{const n=window.location.hash.substring(1),[o,i=""]=n.split("?"),m=new URLSearchParams(i);Object.entries({dateStart:t,dateEnd:s,customerId:r,deliverBoyId:a}).forEach(([c,E])=>{console.log(c,E),E==null||E===""||E===void 0?m.delete(c):m.set(c,E)}),console.log(m.toString());const v=o+(m.toString()?`?${m}`:"");`#${v}`!==window.location.hash&&window.location.replace(window.location.pathname+window.location.search+`#${v}`)},H=(t,s=!1)=>{let r=t.toFixed(2);r.endsWith(".00")&&(r=r.slice(0,-3));const a=Number(r);return a==0&&(r="-"),s&&a>0&&(r="₹"+r),r},Me=t=>t.replace(/\w\S*/g,function(s){return s.charAt(0).toUpperCase()+s.substr(1).toLowerCase()}),dr=xe({name:"connections",initialState:{data:null,isLoading:!1,isError:!1,errorMessage:""},reducers:{connectionByCustomerId:(t,s)=>{t.data=s.payload,t.isLoading=!1,t.isError=!1},connectionError:(t,s)=>{t.isLoading=!1,t.isError=!0,t.errorMessage=s.payload},connectionReset:t=>{t.data=null,t.isLoading=!1,t.isError=!1,t.errorMessage=""},connectionLoading:t=>{t.isLoading=!0,t.isError=!1}}}),wo=()=>async t=>{t(bo())},{connectionByCustomerId:Ni,connectionError:ki,connectionReset:bo,connectionLoading:Ti}=dr.actions,So=dr.reducer;let ms=[];const Co=()=>{const t=pe(),s=J(N=>N.customers),r=J(N=>N.updateCustomer),{gasLoading:a,gasList:n,gasError:o}=J(N=>N.gasList),[i,m]=l.useState(""),[S,v]=l.useState(!1);let[c,E]=l.useState(null);const _=J(N=>N.connections);let x=null;const d=N=>{const V=x.find(X=>X.id==N);E(V),v(!0),t(wo())},u=[];if(Is(s.data)&&s.data.data.length>0){let N=vo(s.data.data,s.data.userdata);x=N,i.length>0&&(N=N.filter(V=>V.user.name.toLowerCase().includes(i.toLowerCase()))),ms.push(...N),N.forEach(V=>{u.push(Eo(V,d))})}l.useEffect(()=>{s.data==null&&!s.isLoading&&!s.isError&&t(Pe()),n.length==0&&!a&&t(jo())}),l.useEffect(()=>{r.isSuccessful&&t(Pe())}),l.useEffect(()=>{Je.listenDataChange(()=>{s.isLoading||t(Pe())})},[]);const[L,T]=l.useState(!1),F=()=>{const[N,V]=l.useState(new Array),[X,ne]=l.useState(!0),[q,te]=l.useState(!0),z=(w,b,D)=>{if(b<1){alert("Quantity should be greater than 0");return}if(N.find(Y=>Y.id===w)){alert("Gas already selected");return}if(n.find(Y=>Y.id===w)==null){alert("Select A Gas");return}V(Y=>[...Y,{id:w,qty:b,price:D}])};console.log(N);const oe=w=>{V(b=>{let D=[...b];return D.splice(w,1),D})},[f,M]=l.useState(""),[j,U]=l.useState(""),[I,P]=l.useState(new Array),[g,R]=l.useState(!1),Q=(w,b)=>{if(b<1){alert("Price should be greater than 0");return}if(w.length===0){alert("Accessory should not be empty");return}P(D=>[...D,{accessory:w,price:b}]),M(""),U("")};console.log(I);const h=w=>{P(b=>{let D=[...b];return D.splice(w,1),D})};return e.jsx(Ne,{open:L,onClose:()=>T(!1),title:"New Connection",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"10px"},children:e.jsx(ct,{children:e.jsxs(me,{sx:{padding:"20px",borderRadius:"10px",backgroundColor:"#fff",boxShadow:"0px 0px 10px 0px #0000001a"},children:[e.jsx(ke,{variant:"outlined"}),e.jsx(ue,{children:"New Connection"}),e.jsx(B,{sx:{p:1,opacity:0}}),e.jsx("form",{onSubmit:w=>{w.preventDefault(),R(!0);const b=new FormData(w.target),D={};b.forEach((Z,ce)=>{D[ce]=Z});let Y=D.diary_no;if(Y.length>0){let Z=!1;if(ms.forEach(ce=>{ce.diaryNumber==Y&&(Z=!0)}),Z){alert("Diary Number already taken"),R(!1);return}}let re=JSON.stringify({name:D.name,phone_no:D.phone,address:D.address,gas:X?[]:N,diaryNumber:D.diary_no,aadhar_card_no:D.aadhar_card_no,accessories:q?[]:I});console.log(re);const W=sessionStorage.getItem("authToken");let ie={method:"post",maxBodyLength:1/0,url:K+"api/createCustomer",headers:{"Content-Type":"application/json",Authorization:`Bearer ${W}`},data:re};Gt.request(ie).then(Z=>{console.log(JSON.stringify(Z.data)),Z.data.success==!0?(t(Pe()),T(!1),R(!1)):(alert("Error Adding Customer"),console.log(Z.data),R(!1))}).catch(Z=>{alert("Error Adding Customer"),console.log(Z),R(!1)})},children:e.jsxs(C,{spacing:2,direction:"column",children:[e.jsxs(Be,{children:[e.jsx(Fe,{children:"Name"}),e.jsx(G,{placeholder:"Name",name:"name",required:!0})]}),e.jsxs(Be,{children:[e.jsx(Fe,{children:"Phone Number"}),e.jsx(G,{placeholder:"Phone",name:"phone",required:!0,type:"tel",onChange:w=>{w.target.value.startsWith("+")&&(w.target.value=w.target.value.substring(1));const D=w.target.value.replace(/[^\d+]/g,"");w.target.value=D},onBlur:w=>{const b=w.target.value.trim();![/^\+91\d{10}$/,/^91\d{10}$/,/^\d{10}$/].some(re=>re.test(b))&&b.length>0&&alert(`Phone number must be in one of these formats:
+919876543210 (13 digits)
919876543210 (12 digits)
9876543210 (10 digits)`)},pattern:"^(\\+91\\d{10}|91\\d{10}|\\d{10})$",title:"Phone number must be: +919876543210 or 919876543210 or 9876543210"})]}),e.jsxs(Be,{children:[e.jsx(Fe,{children:"Address"}),e.jsx(G,{placeholder:"Address",name:"address",required:!0})]}),e.jsxs(Be,{children:[e.jsx(Fe,{children:"Aadhar Card No."}),e.jsx(G,{placeholder:"Aadhar Card No.",type:"number",name:"aadhar_card_no"})]}),e.jsxs(Be,{children:[e.jsx(Fe,{children:"Diary No."}),e.jsx(G,{placeholder:"Diary No.",type:"number",name:"diary_no"})]}),e.jsx(Fe,{sx:{opacity:X?.5:1},children:"Gas List"}),e.jsx(We,{sx:{display:X?"none":"block"},children:N.map((w,b)=>{const D=n.find(Y=>Y.id===w.id);return e.jsxs(we,{sx:{borderWidth:2,borderRadius:"lg",display:"flex",mt:1},children:[e.jsxs(be,{sx:{fontWeight:"bold",flexGrow:1},children:[D.company_name," : ",D.kg,"KG : ",w.qty," QTY : Price ₹",w.price," : TOTAL ₹",w.qty*w.price]}),e.jsx(A,{sx:{display:"flex",justifyContent:"end",padding:1,borderRadius:"lg","&:hover":{backgroundColor:"#CC2B52",color:"#fff"}},onClick:()=>{oe(b)},children:e.jsx(Vt,{})})]},"gas_sel_"+b)})}),e.jsxs(C,{direction:"row",gap:1,sx:{display:X?"none":"flex"},children:[e.jsx(Te,{sx:{flexGrow:1},placeholder:"Select Gas",onChange:(w,b)=>{O=b},children:n.map(w=>N.find(b=>b.id===w.id)?null:e.jsxs(Re,{value:w.id,children:[w.company_name," : ",w.kg,"KG"]},w.id))}),e.jsx(G,{type:"number",placeholder:"Quantity",name:"qty",defaultValue:p,onChange:w=>{p=Number(w.target.value)},startDecorator:e.jsx(ue,{children:"Quantity : "})}),e.jsx(G,{type:"number",placeholder:"Price",name:"price",defaultValue:k,onChange:w=>{k=Number(w.target.value)},startDecorator:e.jsx(ue,{children:"Price : "})}),e.jsx($,{onClick:()=>{z(O,p,k)},children:"Add Gas"})]}),e.jsx(Fe,{sx:{opacity:q?.5:1},children:"Accessory List"}),e.jsx(We,{sx:{display:q?"none":"block"},children:I.map((w,b)=>e.jsxs(we,{sx:{borderWidth:2,borderRadius:"lg",display:"flex",mt:1},children:[e.jsxs(be,{sx:{fontWeight:"bold",flexGrow:1},children:[w.accessory," : ₹",w.price]}),e.jsx(A,{sx:{display:"flex",justifyContent:"end",padding:1,borderRadius:"lg","&:hover":{backgroundColor:"#CC2B52",color:"#fff"}},onClick:()=>{h(b)},children:e.jsx(Vt,{})})]},"accessory_"+b))}),e.jsxs(C,{direction:"row",gap:1,sx:{display:q?"none":"flex"},children:[e.jsx(G,{sx:{flexGrow:1},placeholder:"Accessory",value:f,onChange:w=>{M(w.target.value)}}),e.jsx(G,{sx:{flexGrow:.1},placeholder:"Price",type:"number",value:j,onChange:w=>{U(w.target.value)}}),e.jsx($,{onClick:()=>{Q(f,j)},children:"Add Accessory"})]}),e.jsx(B,{sx:{opacity:0,m:1}}),e.jsx(C,{direction:"row",gap:1,children:e.jsxs(C,{gap:1,sx:{flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"}},children:[e.jsx(It,{label:"",size:"lg",checked:X,onChange:w=>{ne(w.target.checked)}}),e.jsx("span",{style:{fontWeight:"bold",color:"black",minWidth:{xs:"100%",md:"auto"},whiteSpace:"nowrap"},children:"No Gas :"}),e.jsxs(C,{gap:1,sx:{flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"}},children:[e.jsx(It,{label:"",size:"lg",checked:q,onChange:w=>{te(w.target.checked)}}),e.jsx("span",{style:{fontWeight:"bold",color:"black",minWidth:{xs:"100%",md:"auto"},whiteSpace:"nowrap"},children:"No Accessory :"})]})]})}),e.jsx(B,{sx:{opacity:0,m:1}}),g?e.jsx(fe,{}):e.jsx(e.Fragment,{children:e.jsx($,{type:"submit",children:"Add Customer"})})]})})]})})})};if(s.data==null||n.length==0)return e.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto",padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"16px"},children:e.jsx(fe,{})});let p=1,k=0,O=n[0].id,y=null;try{_.data.new_connection&&(y=_.data.new_connection)}catch{}return y=y||[],e.jsxs("div",{style:{width:"100%",height:"100%",overflow:"auto",padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"16px"},children:[e.jsx(F,{}),e.jsxs(C,{direction:"row",mb:1,spacing:1,justifyContent:"flex-end",children:[e.jsx($,{onClick:()=>{T(!0)},startDecorator:e.jsx(Vr,{}),children:"New Connection"}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(ue,{variant:"h4",style:{display:"flex",alignItems:"center"},children:"Search Customer"}),e.jsx(G,{placeholder:"Name",value:i,onChange:N=>m(N.target.value)}),e.jsx($,{startDecorator:e.jsx(Ss,{}),children:"Search"})]}),e.jsx(e.Fragment,{children:e.jsx(Ne,{open:S,onClose:()=>v(!1),title:"All Data",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"10px"},children:e.jsx(ct,{children:e.jsxs(me,{sx:{padding:"20px",borderRadius:"10px",backgroundColor:"#fff",boxShadow:"0px 0px 10px 0px #0000001a",overflow:"auto",height:"80vh"},children:[e.jsx(ke,{variant:"outlined"}),e.jsx(ue,{children:"All Data"}),e.jsx(B,{sx:{p:1,opacity:0}}),e.jsx(We,{children:_.isLoading?e.jsx(fe,{}):e.jsxs(e.Fragment,{children:[e.jsx(we,{children:e.jsx(be,{children:e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-start",children:[e.jsx("pre",{children:"Name"}),":",e.jsx("pre",{children:c?c.user.name:""})]})})}),e.jsx(B,{}),e.jsx(we,{children:e.jsx(be,{children:e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-start",children:[e.jsx("pre",{children:"Address"}),":",e.jsx("pre",{children:c?c.user.address:""})]})})}),e.jsx(B,{}),e.jsx(we,{children:e.jsx(be,{children:e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-start",children:[e.jsx("pre",{children:"Phone Number"}),":",e.jsx("pre",{children:c?c.user.phone_no:""})]})})}),e.jsx(B,{}),e.jsx(we,{children:e.jsx(be,{children:e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-start",children:[e.jsx("pre",{children:"Aadhar Card Number"}),e.jsx(qe,{userId:c!=null?c.user_id:null,custId:c!=null?c.user_id:null,updateUser:!1,name:"aadhar_card_no",type:Qe,text:c!=null&&c.aadhar_card_no?c.aadhar_card_no:0,value:c!=null&&c.aadhar_card_no?c.aadhar_card_no:0,table:Rs},"aadhar_card_no")]})})}),e.jsx(B,{}),e.jsx(we,{children:e.jsx(be,{children:e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-start",children:[e.jsx("pre",{children:"Diary Number"}),":",e.jsx("pre",{children:c?c.diaryNumber:""})]})})}),e.jsx(B,{})]})})]})})})}),e.jsx(an,{thead:[e.jsx(Ue,{children:e.jsx(Cs,{})},"all_data"),e.jsx(Ue,{children:"Diary No."},"diary_no"),e.jsx(Ue,{children:"Name"},"name"),e.jsx(Ue,{children:"Address"},"address"),e.jsx(Ue,{children:"Phone No."},"phone_no"),e.jsx(Ue,{children:"Balance"},"balance"),e.jsx(Ue,{children:"History"},"history")],tbody:u,loading:s.isLoading})]})};function vo(t,s){return t.map(r=>{const a=s.find(n=>n.id===r.user_id);return{...r,user:a}})}function Eo(t,s){return[e.jsx(_o,{data:t,onClick:s},"all_data"),e.jsx(qe,{userId:t.user_id,custId:t.id,updateUser:!1,name:"diaryNumber",type:Qe,text:t.diaryNumber?t.diaryNumber:0,value:t.diaryNumber?t.diaryNumber:0,table:Rs},"diaryNumber"),e.jsx(qe,{userId:t.user_id,custId:t.id,updateUser:!0,name:"name",type:os,text:t.user.name,value:t.user.name,table:yt},"name"),e.jsx(qe,{userId:t.user_id,custId:t.id,updateUser:!0,name:"address",type:os,text:t.user.address,value:t.user.address,table:yt},"address"),e.jsx(qe,{userId:t.user_id,custId:t.id,updateUser:!0,name:"phone_no",type:Qe,text:t.user.phone_no,value:t.user.phone_no,table:yt},"phone_no"),e.jsx("span",{className:"b ps1",children:`₹${t.totalBalance}`},"tb"),e.jsx(A,{sx:{padding:"0px",margin:"0px",backgroundColor:"transparent",mx:"2px",transition:"background-color 0.3s","&:hover":{backgroundColor:"rgb(75 112 245 / 25%)"},pl:1},children:e.jsx($,{style:{flexGrow:1,width:"100%",height:"100%",margin:"0px",padding:"0px",borderRadius:"0px",backgroundColor:"transparent",whiteSpace:"nowrap",textAlign:"center",disabled:!0,justifyContent:"flex-start",color:"#185ea5"},onClick:()=>{window.location.href=`/admin/#/admin/deliveryHistory/?customerId=${t.id}`},children:"History"})},"chb")]}function _o({data:t,onClick:s}){return e.jsx(A,{sx:{padding:"0px",margin:"0px",backgroundColor:"transparent",mx:"2px",transition:"background-color 0.3s","&:hover":{backgroundColor:"rgb(75 112 245 / 25%)"}},children:e.jsx($,{style:{flexGrow:1,width:"100%",height:"100%",margin:"0px",padding:"0px",borderRadius:"0px",backgroundColor:"transparent",whiteSpace:"nowrap",textAlign:"center",disabled:!0,color:"#377e3a",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{s(t.id)},children:e.jsx(Cs,{})})},"chb")}const vt=je("login/fetchLogin",async t=>{let s=!0,r="",a=null,n=null;try{if(t.isLoadFromCookie){let o=Wa();o!==null&&o.token!==void 0&&o.token!==""&&o.token!==null&&(a=o,n=o.token,s=!1)}else{const{username:o,password:i}=t;console.log(o,i);const S=await(await fetch(Ts,{method:"post",headers:{"ngrok-skip-browser-warning":"69420","Content-Type":"application/json"},body:JSON.stringify({username:o,password:i})}).catch(v=>{console.warn(v),s=!0,r=v.message})).json();console.log(S),a=S,n=S.token,S.token==null||S.token==""||S.token==null?(s=!0,r="Invalid username or password please check"):(ko(a),s=!1)}}catch(o){console.warn(o),s=!0,r=o.message}return{data:a,token:n,isError:s,errorMessage:r}}),Do=xe({name:"login",initialState:{isLoading:!1,data:null,isError:!1,errorMessage:"",token:null},extraReducers:t=>{t.addCase(vt.pending,(s,r)=>{s.isLoading=!0}),t.addCase(vt.fulfilled,(s,r)=>{s.isLoading=!1,s.data=r.payload.data,s.isError=r.payload.isError,s.errorMessage=r.payload.errorMessage,s.token=r.payload.token}),t.addCase(vt.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),No=Do.reducer;function ko(t){document.cookie=`token=${t.token}`,document.cookie=`user_id=${t.LoginInfo.user_id}`,document.cookie=`role=${t.LoginInfo.role}`,document.cookie=`username=${t.LoginInfo.username}`,document.cookie=`name=${t.userDetails[0].name}`}function To(){const t=pe(),s=J(T=>T.getData),r=J(T=>T.updateCustomer),a=J(T=>T.loginV2.isLoading),n=J(T=>T.loginV2.updated),[o,i]=l.useState(!1),m=[],S=[],[v,c]=le.useState(()=>{const T=new Date(new Date().getFullYear(),new Date().getMonth(),1),F=T.getFullYear(),p=String(T.getMonth()+1).padStart(2,"0"),k=String(T.getDate()).padStart(2,"0");return`${F}-${p}-${k}`}),[E,_]=le.useState(()=>{const T=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),F=T.getFullYear(),p=String(T.getMonth()+1).padStart(2,"0"),k=String(T.getDate()).padStart(2,"0");return`${F}-${p}-${k}`});let x=window.location.href;x=x.split("?")[0],x=x+`?&start_date=${v}&end_date=${E}`,window.location.href=x;let d="";d=ns+"?"+new URLSearchParams({startDate:v,endDate:E}).toString(),s.data!==null&&s.data.length>0&&ps(s.url)==ps(ns)&&s.data.forEach(T=>{T.login!=null&&(m.push(Ro(T,T.expenses_sum_amount,o)),S.push(T))});const u=()=>{t(Ee(d))};n&&(u(),t(pn())),l.useEffect(()=>{(s.data==null||new URL(s.url).pathname!=new URL(d).pathname)&&t(Ee(d)),r.isSuccessful&&t(Ee(d))});const L=()=>{const[T,F]=l.useState(!1);return T?e.jsx(Ne,{open:T,onClose:()=>F(!1),title:"New Connection",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"10px"},children:e.jsx(ct,{maxWidth:"xs",children:e.jsxs(me,{sx:{padding:"20px",borderRadius:"10px",backgroundColor:"#fff",boxShadow:"0px 0px 10px 0px #0000001a"},children:[e.jsx(ke,{variant:"outlined"}),e.jsx(ue,{children:"New Delivery Boy"}),e.jsx(B,{sx:{p:1,opacity:0}}),e.jsx("form",{onSubmit:p=>{p.preventDefault();const k=new FormData(p.target),O={};k.forEach((X,ne)=>{O[ne]=X}),console.log(O);let y=JSON.stringify({name:O.name,username:O.username,password:O.password,phone:O.phone});const N=sessionStorage.getItem("authToken");let V={method:"post",maxBodyLength:1/0,url:K+"api/createDeliveryBoy",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},data:y};F(!1),Gt.request(V).then(X=>{console.log(X.data),t(Ee(d))}).catch(X=>{console.log(X)})},children:e.jsxs(C,{spacing:2,direction:"column",children:[e.jsx(G,{placeholder:"Full Name",name:"name",required:!0}),e.jsx(G,{placeholder:"Phone Number",name:"phone",required:!0}),e.jsx(G,{placeholder:"User Name",name:"username",required:!0}),e.jsx(G,{placeholder:"Password",name:"password",required:!0}),e.jsx($,{type:"submit",children:"Add"})]})})]})})}):e.jsx($,{sx:{mb:1},onClick:()=>F(!0),children:"New Delivery Boy"})};return e.jsxs("div",{style:{height:"100%",width:"100%",overflow:"auto",padding:"10px",backgroundColor:"white",borderRadius:"10px"},children:[e.jsxs(C,{direction:"row",mb:1,spacing:1,justifyContent:"flex-end",children:[e.jsxs(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",children:[e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:"Date Start : "}),e.jsx(G,{type:"date",sx:{width:"100%"},onChange:T=>{hs({startDate:T.target.value}),c(T.target.value)},defaultValue:v})]}),e.jsxs(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",mr:2,children:[e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:"Date End : "}),e.jsx(G,{type:"date",sx:{width:"100%"},onChange:T=>{hs({endDate:T.target.value}),_(T.target.value)},defaultValue:E})]}),e.jsx(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",mr:2,children:e.jsx($,{onClick:()=>{u()},children:"OK"})}),e.jsx(B,{sx:{flexGrow:1,opacity:0}}),e.jsx(L,{})]}),e.jsx("div",{style:{display:s.isLoading||a?"block":"none"},children:e.jsx(fe,{color:"primary",variant:"soft"})}),e.jsxs(ye,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Password"}),e.jsx("th",{onMouseDown:()=>{i(!0)},onMouseUp:()=>{i(!1)},onMouseLeave:()=>{i(!1)},children:"Number"}),e.jsxs("th",{colSpan:3,children:["Expense : ",e.jsx("i",{children:Io()})]})]})}),e.jsx("tbody",{children:m.map((T,F)=>e.jsxs("tr",{children:[T.map((p,k)=>e.jsx("td",{children:p},k)),e.jsx("td",{children:e.jsx(ve,{to:"/admin/expence?user_id="+S[F].id+"&user_name="+S[F].username+"&start_date="+v+"&end_date="+E,children:e.jsx($,{variant:"soft",color:"success",sx:{width:"100%"},children:"View Expences"})})}),e.jsx("td",{children:e.jsx(ve,{to:`/admin/deliveryHistory?deliverBoyId=${S[F].id}`,children:e.jsx($,{variant:"soft",color:"warning",sx:{width:"100%"},children:"View Deliveries"})})})]},F))})]})]})}function Ro(t,s,r){let a=t.login.phone;r&&(a=t.login.phone+`[${t.otp?.otp}]`),console.log(a);const n=pe();return[e.jsx(Et,{value:t.login.username,onUpdate:o=>{n(Ct({username:o,id:t.login.id}))}}),e.jsx(Et,{value:t.login.password,onUpdate:o=>{n(Ct({password:o,id:t.login.id}))}}),e.jsx(Et,{value:a,onUpdate:o=>{n(Ct({phone:o,id:t.login.id}))}}),e.jsxs("span",{style:{fontSize:"1.2em",fontWeight:"bold"},children:["₹",s]})]}function Io(){let t=new Date().getMonth(),s="";switch(t){case 0:s="January";break;case 1:s="February";break;case 2:s="March";break;case 3:s="April";break;case 4:s="May";break;case 5:s="June";break;case 6:s="July";break;case 7:s="August";break;case 8:s="September";break;case 9:s="October";break;case 10:s="November";break;case 11:s="December";break}return s}function ps(t){let s=new URL(t);return s.search="",s.toString()}const Et=({value:t,onUpdate:s})=>{const[r,a]=l.useState(t),[n,o]=l.useState(!1);return e.jsx(e.Fragment,{children:e.jsx(G,{type:"text",value:r,onChange:i=>{a(i.target.value)},onBlur:i=>{r!=t&&(confirm(`Update ${t} to ${r} ?`)&&!n?s(r):a(t))},sx:{border:"none"},endDecorator:r!=t&&e.jsx(Ds,{onClick:()=>{o(!0)},sx:{ml:1,"&:hover":{backgroundColor:"rgb(75 112 245 / 25%)"}},children:e.jsx(zr,{})})})})},ur=K+"api/expenses",Ao="EXPENSES_INIT_STATE",hr="EXPENSES_REQUEST",mr="EXPENSES_SUCCESS",pr="EXPENSES_FAILURE",xr=()=>({type:hr}),Lo=t=>({type:mr,payload:t}),gr=t=>({type:pr,payload:t}),fr=t=>async s=>{s(xr()),console.log("params : ",t);try{const r=await ee().get(ur,{params:t});let a=r.headers["x-log-data"];a=decodeURIComponent(a),console.log("xlog : ",a),s(Lo(r.data))}catch(r){s(gr(r.message))}},xs=t=>async s=>{s(xr());try{const r=await ee().put(ur+"/"+t.id,t);s(fr())}catch(r){s(gr(r.message))}};function Fo(){const t=window.location.href,s=t.indexOf("#"),r=t.substring(s+1),a=new URL(r,window.location.origin),n=new URLSearchParams(a.search),o=n.get("user_id"),i=n.get("user_name"),m=n.get("start_date"),S=n.get("end_date"),[v,c]=le.useState(()=>{if(m)return m;{const k=new Date(new Date().getFullYear(),new Date().getMonth(),1),O=k.getFullYear(),y=String(k.getMonth()+1).padStart(2,"0"),N=String(k.getDate()).padStart(2,"0");return`${O}-${y}-${N}`}});console.log(v);const[E,_]=le.useState(()=>{if(S)return S;{const k=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),O=k.getFullYear(),y=String(k.getMonth()+1).padStart(2,"0"),N=String(k.getDate()).padStart(2,"0");return`${O}-${y}-${N}`}}),x=pe(),{expenses:d,expenceLoading:u,expenceError:L}=J(k=>k.expence);console.log({expenses:d,expenceLoading:u,expenceError:L});const T=d.reduce((k,O)=>k+O.amount,0);console.log(d,o);let F=d.filter(k=>k.user_id==o);const p=()=>{x(fr({user_id:o,startDate:v,endDate:E}))};return l.useEffect(()=>{p()},[v,E]),l.useEffect(()=>{Je.listenDataChange(()=>{u||(console.log("fetching..."),p())})},[]),e.jsxs(A,{sx:{backgroundColor:"white",height:"100%"},children:[e.jsxs(C,{direction:"row",gap:1,alignItems:"center",children:[e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:28,ml:1,transform:"rotate(90deg)",padding:1,borderWidth:2,borderRadius:"md","&:hover":{backgroundColor:"#FFF4B7"}},onClick:()=>{window.history.back()},children:e.jsx(Yr,{})}),e.jsxs("span",{style:{textAlign:"center",fontSize:"20px",fontWeight:"bold",color:"black",padding:"16px"},children:["Expences of ",i," : ",e.jsxs("i",{children:["₹",T]})]}),e.jsx(B,{sx:{flexGrow:1}}),e.jsxs(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",children:[e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:"Date Start : "}),e.jsx(G,{type:"date",sx:{width:"100%"},onChange:k=>{c(k.target.value)},defaultValue:v})]}),e.jsxs(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",mr:2,children:[e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:"Date End : "}),e.jsx(G,{type:"date",sx:{width:"100%"},onChange:k=>{_(k.target.value)},defaultValue:E})]}),e.jsx(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",mr:2,children:e.jsx($,{onClick:p,children:"OK"})})]}),e.jsx(fe,{sx:{display:u?"block":"none"}}),e.jsxs(ye,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Amount"})]})}),e.jsx("tbody",{children:F.map(k=>e.jsxs("tr",{style:{backgroundColor:k.error?"#ffe8e8":"white"},children:[e.jsx("td",{style:{fontWeight:"bold",color:k.error?"red":"black"},children:Uo(k.created_at)}),e.jsx("td",{style:{fontWeight:"bold"},children:e.jsx(A,{sx:{transition:"all 0.3s",borderRadius:"md","&:hover":{backgroundColor:"lightblue",p:1}},onClick:()=>{const O=prompt("Enter reason",k.reason);O&&x(xs({id:k.id,reason:O,error:!1,phone:!1}))},children:e.jsx("span",{className:"b",style:{color:k.error?"red":"black"},children:k.reason})})}),e.jsx("td",{style:{fontWeight:"bold"},children:e.jsx(A,{sx:{transition:"all 0.3s",borderRadius:"md","&:hover":{backgroundColor:"lightblue",p:1}},onClick:()=>{const O=prompt("Enter new amount",k.amount);O&&x(xs({id:k.id,amount:O,error:!1,phone:!1}))},children:e.jsxs("span",{className:"b",style:{color:k.error?"red":"black"},children:["₹",k.amount]})})})]},k.id))})]})]})}function Uo(t){const s=new Date(t),r=s.getMonth()+1,a=s.getDate(),n=s.getFullYear();return`${r}/${a}/${n}`}const gt="FETCH_ITEMS_REQUEST",Go="FETCH_ITEMS_SUCCESS",yr="FETCH_ITEMS_FAILURE",jr="CREATE_ITEM_SUCCESS",wr="UPDATE_ITEM_SUCCESS",br="DELETE_ITEM_SUCCESS",Sr="INITIAL_ITEMS",Po=()=>async t=>{t({type:Sr})},Oo=t=>async s=>{s({type:gt});try{const r=await ee().post(K+"api/purchase-order-items",t);s({type:jr,payload:r.data})}catch(r){r.response.status===401&&s(Oe()),console.error(r)}},_t=(t,s)=>async r=>{r({type:gt});try{const a=await ee().put(K+`api/purchase-order-items/${t}`,s);r({type:wr,payload:a.data})}catch(a){a.response.status===401&&r(Oe()),r({type:yr,error:a}),console.error(a)}},Wo=t=>async s=>{s({type:gt});try{await ee().delete(K+`api/purchase-order-items/${t}`),s({type:br,payload:t})}catch(r){r.response.status===401&&s(Oe()),console.error(r)}};function Mo({gaslistData:t,plants:s}){const r=pe(),[a,n]=l.useState(0),[o,i]=l.useState(.01),[m,S]=l.useState(.01),[v,c]=l.useState(0),[E,_]=l.useState(0),[x,d]=l.useState(!1),[u,L]=l.useState([]);if(t!=null&&t.length===0||s==null||s.length===0)return e.jsx(e.Fragment,{});const T=new Map;t.forEach(j=>{T.set(j.id,j)});const F={borderWidth:0,width:1},p={borderWidth:0};let k=0,O=0,y=0,N=0,V=0,X=0;u.forEach(j=>{O+=Number(j.qty),y+=Number(j.qty)*Number(T.get(j.gas_id).kg),k+=Number(j.qty)*Number(T.get(j.gas_id).kg)*Number(j.rate),V+=Number(j.return_cyl_qty),X+=Number(j.return_cyl_qty)*Number(T.get(j.gas_id).kg)});const ne=y*v,q=o*k,te=m*y,z=k+q+te-ne-E;N=z-a,a===void 0&&(N=z);const oe=j=>{const U=u.filter((I,P)=>P!==j);L(U)},f=(j,U,I)=>{if(U==="id"||U==="gas_id"){L(u.map((P,g)=>g===j?{...P,[U]:I}:P));return}try{const P=u.map((g,R)=>{const Q=I.split("");let h="",w=0;return Q.forEach(b=>{(b==="."||b===","||U==="qty"||U==="return_cyl_qty"||U==="gas_id")&&w++,b.match(/[0-9]/)&&(h+=b),b==="."&&w<=1&&(h+=b)}),h.startsWith(".")&&(h="0"+h),h=h.replace(/^0+(\d)/,"$1"),h.length===0&&(h=0),R===j?{...g,[U]:h}:g});L(P)}catch(P){console.warn(P)}},M=()=>{try{const j=t.find(I=>I.company_name==="GO GAS"&&u.find(P=>P.gas_id===I.id)==null),U=[...u,{gas_id:j.id,qty:0,rate:0,return_cyl_qty:0}];L(U)}catch(j){console.warn(j);return}};return e.jsxs(e.Fragment,{children:[e.jsx($,{variant:"solid",size:"sm",sx:{backgroundColor:"#12467b"},startDecorator:e.jsx(zt,{}),onClick:()=>d(!0),children:"Add Purchase"}),e.jsx(Ne,{"aria-labelledby":"modal-title","aria-describedby":"modal-desc",open:x,onClose:()=>d(!1),sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(ct,{maxWidth:"xl",children:e.jsxs(me,{variant:"outlined",sx:{borderRadius:"md",p:3,boxShadow:"lg",maxHeight:"100vh",overflow:"auto"},children:[e.jsx(ke,{variant:"plain",sx:{m:1}}),e.jsx(ue,{component:"h2",id:"modal-title",level:"h4",textColor:"inherit",fontWeight:"lg",children:"Add Purchase"}),e.jsx(fe,{sx:{my:1,width:"100%",display:"none"}}),e.jsx(B,{sx:{my:1}}),e.jsx("form",{onSubmit:j=>{j.preventDefault();const U=new FormData(j.currentTarget),I=Object.fromEntries(U.entries());I.scheme=v,I.purchase_order_items=u,U.tcs=o,U.for_charges=m,U.defective_amount=E,r(wn(I)),d(!1)},children:e.jsxs(C,{direction:"column",gap:1,sx:{width:"100%",borderRadius:"md",padding:1,marginTop:1,backgroundColor:"transparent",color:"black"},children:[e.jsxs(C,{direction:"row",gap:1,children:[e.jsx(G,{placeholder:"Date",type:"date",name:"date",required:!0,size:"sm",onKeyDown:j=>{try{j.preventDefault()}catch(U){console.warn(U)}},onFocus:j=>{try{j.target.showPicker()}catch(U){console.warn(U)}},onClick:j=>{try{j.target.showPicker()}catch(U){console.warn(U)}},sx:{width:"100%",flexGrow:1}}),e.jsx(G,{placeholder:"Order No.",type:"text",name:"order_no",size:"sm",required:!0,sx:{width:"100%",flexGrow:1}}),e.jsx(Te,{placeholder:"Plant",required:!0,name:"plant_id",size:"sm",sx:{width:"100%",flexGrow:1},children:s.map(j=>e.jsx(Re,{value:j.id,children:j.name},j.id))}),e.jsx(G,{sx:{width:"100%",flexGrow:1},placeholder:"Scheme",size:"sm",type:"text",name:"scheme_type",required:!0}),e.jsx(G,{sx:{width:"100%",flexGrow:1},value:v,onChange:j=>{const I=j.target.value.split("");let P="",g=0;I.forEach(R=>{(R==="."||R===",")&&g++,R.match(/[0-9]/)&&(P+=R),R==="."&&g<=1&&(P+=R)}),P.startsWith(".")&&(P="0"+P),P=P.replace(/^0+(\d)/,"$1"),P.length===0&&(P=0),c(P)},placeholder:"Scheme Rate",size:"sm",type:"number",name:"scheme_rate",required:!0,endDecorator:e.jsxs(ge,{variant:"outlined",style:{fontWeight:"bold",backgroundColor:"#47474721"},children:["₹",ne.toFixed(2)]})})]}),e.jsx(_e,{children:e.jsx(_s,{sx:{display:"flex"},children:e.jsxs(ye,{sx:{width:"100%",flexGrow:1,tableLayout:"fixed",fontWeight:"bold"},size:"sm",children:[e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:" Cyl."})})}),e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:" "})})}),e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:" Qty."})})}),e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Total Kg"})})}),e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Rate"})})}),e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Total Amt"})})}),e.jsx("th",{style:F,children:e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Return Cyl. Qty."})})}),e.jsx("th",{style:F,children:"Total"})]}),e.jsx("tr",{children:e.jsx("th",{colSpan:8,style:{borderWidth:0,width:1,height:1},children:e.jsx(B,{orientation:"horizontal"})})})]}),e.jsxs("tbody",{children:[u.map((j,U)=>e.jsxs("tr",{children:[e.jsx("td",{style:{borderWidth:0},colSpan:2,children:e.jsx(Te,{color:"neutral",placeholder:"select Gas",size:"sm",variant:"outlined",name:"gas_id",defaultValue:j.gas_id,onChange:(I,P)=>{if(u.find(g=>g.gas_id===P)!=null){alert("Gas already added");return}f(U,"gas_id",P)},required:!0,sx:{flexGrow:1,width:"100%"},children:t.map(I=>{if(I.company_name==="GO GAS")return e.jsx(Re,{value:I.id,label:`${I.company_name} : ${I.kg} KG`,sx:{backgroundColor:"transparent",color:"black"},onClick:()=>{},children:`${I.company_name} : ${I.kg} KG`},I.id)})})}),e.jsx("td",{colSpan:2,style:p,children:e.jsx(G,{placeholder:"Quantity",type:"text",name:"qty",size:"sm",sx:{flexGrow:1,width:"100%"},required:!0,value:j.qty,onChange:I=>f(U,"qty",I.target.value),endDecorator:e.jsx(ge,{style:{fontWeight:"bold",backgroundColor:"#474747",color:"white"},children:`Total : ${parseInt(j.qty*T.get(j.gas_id).kg)} KG`})})}),e.jsx("td",{colSpan:2,style:p,children:e.jsx(G,{placeholder:"Rate",type:"text",name:"rate",size:"sm",sx:{flexGrow:1,width:"100%"},required:!0,endDecorator:e.jsx(ge,{style:{fontWeight:"bold",backgroundColor:"#0A6847",color:"white"},children:`Total : ₹${(T.get(j.gas_id).kg*j.qty*j.rate).toFixed(2)}`}),value:j.rate,onChange:I=>f(U,"rate",I.target.value)})}),e.jsx("td",{colSpan:2,style:p,children:e.jsxs(C,{direction:"row",gap:1,children:[e.jsx(G,{placeholder:"Return Qty",type:"text",name:"return_cyl_qty",size:"sm",sx:{flexGrow:1},required:!0,value:j.return_cyl_qty,onChange:I=>{if(console.log(j.qty,I.target.value),j.qty<I.target.value){alert("Return qty should be less than qty");return}f(U,"return_cyl_qty",I.target.value)},endDecorator:e.jsx(ge,{style:{fontWeight:"bold",backgroundColor:"#474747",color:"white"},children:`Total : ${parseInt(j.return_cyl_qty*T.get(j.gas_id).kg+"")} KG`})}),e.jsx($,{variant:"outlined",color:"danger",onClick:()=>{window.confirm("Are you sure you want to delete this item?")&&oe(U)},children:e.jsx(vs,{})})]})})]},`order-item-${j.id}-${U}`)),e.jsx("tr",{children:e.jsx("td",{style:p,colSpan:8,children:e.jsx($,{startDecorator:e.jsx(Jr,{}),variant:"outlined",sx:{marginTop:1,width:"100%"},onClick:()=>M(),children:"Add"})})})]})]})})}),e.jsxs(C,{direction:"row",gap:1,alignContent:"center",children:[e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"TCS :"})}),e.jsx(G,{placeholder:"TCS",type:"number",name:"tcs",required:!0,value:o,onChange:j=>i(j.target.value),endDecorator:e.jsxs(ge,{variant:"outlined",style:{fontWeight:"bold",backgroundColor:"#47474721"},children:["₹",q.toFixed(2)]})}),e.jsx(B,{orientation:"vertical"}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"FOR :"})}),e.jsx(G,{placeholder:"FOR",type:"number",name:"for_charges",required:!0,value:m,onChange:j=>S(j.target.value),endDecorator:e.jsxs(ge,{variant:"outlined",style:{fontWeight:"bold",backgroundColor:"#47474721"},children:["₹",te.toFixed(2)]})}),e.jsx(B,{orientation:"vertical"}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Defective Amount :"})}),e.jsx(G,{placeholder:"Defective Pay",type:"number",name:"defective_amount",required:!0,value:E,onChange:j=>{_(j.target.value)}}),e.jsx(B,{orientation:"vertical"}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Paid :"})}),e.jsx(G,{placeholder:"Amt Pay",type:"number",name:"pay_amt",required:!0,value:a,onChange:j=>{n(j.target.value)}})]}),e.jsx(B,{sx:{my:1}}),e.jsxs(C,{direction:"row",children:[e.jsx(ye,{sx:{tableLayout:"auto",fontWeight:"bold"},size:"sd",borderAxis:"none",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{style:{width:1,borderWidth:0},children:"Billing Amt"}),e.jsx("td",{style:{borderWidth:0,width:1},children:" : "}),e.jsx("td",{style:{borderWidth:0},children:e.jsx(C,{direction:"row",gap:1,alignItems:"center",children:e.jsx(Jt,{placement:"right",size:"lg",color:"success",arrow:!0,variant:"outlined",title:`${k.toFixed(2)} + ${q.toFixed(2)} + ${te.toFixed(2)} - ${ne.toFixed(2)} - ${E}`,children:e.jsx("span",{style:{color:"green",fontWeight:"bold"},children:`₹${z.toFixed(2)}`})})})})]}),e.jsxs("tr",{children:[e.jsx("th",{style:{width:1,borderWidth:0},children:"Ballance"}),e.jsx("td",{style:{borderWidth:0,width:1},children:" : "}),e.jsx("td",{style:{borderWidth:0},children:e.jsx(Jt,{placement:"right",size:"lg",arrow:!0,variant:"outlined",title:`${z.toFixed(2)} - ${a}`,children:e.jsxs("span",{style:{fontWeight:"bold"},children:["₹",N.toFixed(2)]})})})]}),e.jsxs("tr",{children:[e.jsx("th",{style:{width:1,borderWidth:0},children:"Total Qty"}),e.jsx("td",{style:{borderWidth:0,width:1},children:" : "}),e.jsx("td",{style:{borderWidth:0},children:O})]}),e.jsxs("tr",{children:[e.jsx("th",{style:{width:1,borderWidth:0},children:"Total Kg"}),e.jsx("td",{style:{borderWidth:0,width:1},children:" : "}),e.jsx("td",{style:{borderWidth:0},children:y})]}),e.jsxs("tr",{children:[e.jsx("th",{style:{width:1,borderWidth:0},children:"Total Return Qty"}),e.jsx("td",{style:{borderWidth:0,width:1},children:" : "}),e.jsx("td",{style:{borderWidth:0},children:V})]}),e.jsxs("tr",{children:[e.jsx("th",{style:{width:1,borderWidth:0},children:"Total Return Kg"}),e.jsx("td",{style:{borderWidth:0,width:1},children:" : "}),e.jsx("td",{style:{borderWidth:0},children:X})]})]})}),e.jsxs(A,{sx:{display:"flex",alignItems:"center"},children:[e.jsx($,{variant:"outlined",onClick:()=>d(!1),children:"Cancel"}),e.jsx("span",{style:{width:"10px"}}),e.jsx($,{startDecorator:e.jsx(zt,{}),type:"submit",children:"Save"})]})]})]})})]})})})]})}let pt=[],xt=new Map;function $o(){const t=pe(),s=J(y=>y.gas),{plants:r,plantsLoading:a,plantsError:n,plantsUpdateSuccess:o}=J(y=>y.plants),{updateOrderSuccsess:i,orders:m,loading:S,error:v}=J(y=>y.purchaseOrders);v&&console.warn(v);const{itemLoading:c,items:E,itemError:_,itemUpdateSuccess:x}=J(y=>y.purchaseOrderItems);_&&console.warn(_);let d=0,u=0;new Date().toISOString().split("T")[0],new Date(new Date().setMonth(new Date().getMonth()-1)).toISOString().split("T")[0];const[L,T]=l.useState(()=>{const y=new Date;return new Date(y.getFullYear(),y.getMonth(),1).toLocaleDateString("en-GB").split("/").reverse().join("-")}),[F,p]=l.useState(()=>{const y=new Date;return new Date(y.getFullYear(),y.getMonth()+1,0).toLocaleDateString("en-GB").split("/").reverse().join("-")});l.useEffect(()=>{t(ut({startDate:L,endDate:F})),r.length===0&&t(At()),s.data===null&&t(De())},[t,L,F]),l.useEffect(()=>{(x||i)&&(t(Po()),t(jn()),t(ut({startDate:L,endDate:F})),r.length===0&&t(At()),s.data===null&&t(De()))});const k=[];s.data!=null&&(s.data.data.forEach(y=>{xt.set(y.id,y)}),pt=s.data.data),console.log({orders:m}),s.data!=null&&m!=null&&m.length>0&&m.forEach((y,N)=>{const V=y.order_no,X=y.date,ne=y.scheme_type,q=Number(y.pay_amt),te=Number(y.tcs),z=Number(y.for_charges),oe=Number(y.scheme),f=r.filter(D=>D.id===y.plant_id)[0],M=Number(y.defective_amount);let j=0,U=0,I=0,P=0,g=0,R=0,Q=0,h=0,w=0,b=y.cleared;y.items.length===0&&k.push(e.jsx("tr",{children:e.jsxs("td",{style:{borderWidth:0,padding:6,margin:0,backgroundColor:"#FFB0B0"},colSpan:12,children:[e.jsxs(C,{direction:"row",gap:1,children:[e.jsx("span",{style:{fontWeight:"bold"},children:`Order No. ${V}`}),e.jsxs("span",{style:{fontWeight:"bold"},children:["|",` ${X}`]}),e.jsxs("span",{style:{fontWeight:"bold"},children:["|",` Scheme ${ne}`]}),e.jsxs("span",{style:{fontWeight:"bold"},children:["|",` Scheme Rate ${oe}`]})]}),e.jsxs(C,{direction:"row",gap:1,children:[e.jsx(Xr,{style:{fontSize:"20px",transform:"scaleX(-1)"}}),e.jsx("span",{style:{fontWeight:"bold"},children:"No Gas Added Please Add Gas from the edit option"})]})]})},`order-row-empty-${y.id}`)),y.items.forEach((D,Y)=>{const re=xt.get(D.gas_id),W=re.kg,ie=D.qty,Z=D.return_cyl_qty,ce=D.rate,Ie=W*ie,Ae=W*Z,et=Ie*ce;j+=ie,U+=Ie,w+=Ae,I+=et,k.push(e.jsxs("tr",{children:[e.jsx(he,{id:y.id,data:V,tableName:"purchase_orders",column:"order_no"}),e.jsx(he,{id:y.id,data:X,tableName:"purchase_orders",column:"date"}),e.jsx("td",{style:{borderWidth:0,padding:0,margin:0},children:e.jsx("form",{onSubmit:Ce=>{Ce.preventDefault();const Le=new FormData(Ce.currentTarget),$e=Object.fromEntries(Le.entries());console.log($e)},children:e.jsx(Te,{placeholder:"Plant",name:"plant_id",size:"sm",defaultValue:f.id,sx:{backgroundColor:"transparent",borderColor:"transparent"},onChange:(Ce,Le)=>{confirm(`Change Plant from ${f.name} to ${r.filter(tt=>tt.id===Le)[0].name} ?`)&&t(ht(y.id,{plant_id:Le}))},children:r.map(Ce=>e.jsx(Re,{value:Ce.id,children:Ce.name},Ce.id))})})}),e.jsx(he,{id:y.id,data:ne,tableName:"purchase_orders",column:"scheme_type"}),e.jsx(he,{id:y.id,data:oe,tableName:"purchase_orders",column:"scheme"}),e.jsx(he,{id:D.id,data:re,tableName:"purchase_order_items",column:"gas_id"}),e.jsx(he,{id:D.id,data:ie,tableName:"purchase_order_items",column:"qty"}),e.jsx(he,{id:y.id,data:Ie+" KG",editable:!1,tableName:"",column:""}),e.jsx(he,{id:D.id,data:ce,tableName:"purchase_order_items",column:"rate"}),e.jsx(he,{id:y.id,data:"₹"+et.toFixed(2),editable:!1,tableName:"",column:""}),e.jsx(he,{id:D.id,data:Z,tableName:"purchase_order_items",column:"return_cyl_qty"}),e.jsx(he,{id:y.id,data:Ae+" KG",editable:!1,tableName:"",column:""})]},`order-row-${y.id}-${Y}`))}),g=z*U,P=te*I,R=oe*U,I+=g+P-R,b||(d+=I,u+=q),I=I-M,Q=I-q,k.push(e.jsx("tr",{children:e.jsx("td",{style:{borderWidth:0,padding:0,margin:0},colSpan:12,children:e.jsx(le.Fragment,{children:e.jsxs(Bo,{order:y,data:{kg:U,qty:j,amt:I.toFixed(2),pay_amt:q,remaning_amt:Q.toFixed(2),rKg:w,rQty:h,defective_amount:M},children:[e.jsx("div",{style:{width:"100%",flexGrow:1}}),e.jsx(We,{sx:{},size:"md",children:[{label:"Total Kg",value:U},{label:"Total Qty",value:j},{label:"Total Return Kg",value:w},{label:"Total Return Qty",value:h},{label:"Defective Amount",value:e.jsxs(le.Fragment,{children:[" ",e.jsx(he,{column:"defective_amount",id:y.id,data:M,tableName:"purchase_orders"})]})},{label:"Scheme",value:e.jsxs(le.Fragment,{children:[" ",e.jsx(he,{column:"scheme",id:y.id,data:oe,tableName:"purchase_orders"})]})},{label:"Total Scheme",value:R.toFixed(2)},{label:"TCS",value:e.jsxs(le.Fragment,{children:[" ",e.jsx(he,{column:"tcs",id:y.id,data:te,tableName:"purchase_orders"})]})},{label:"Total TCS",value:P.toFixed(2)},{label:"FOR",value:e.jsxs(le.Fragment,{children:[" ",e.jsx(he,{column:"for_charges",id:y.id,data:z,tableName:"purchase_orders"})]})},{label:"Total FOR",value:g.toFixed(2)},{label:"------------",value:"------------"},{label:"Total Amt",value:I.toFixed(2)},{label:"Pay Amt",value:e.jsxs(le.Fragment,{children:[" ",e.jsx(he,{column:"pay_amt",id:y.id,data:q,tableName:"purchase_orders"})]})},{label:"Pending Amt",value:Q.toFixed(2)}].map((D,Y)=>e.jsxs(we,{children:[e.jsx(be,{sx:{textAlign:"end"},children:D.label}),e.jsx(Ke,{children:":"}),e.jsx(Ke,{sx:{textAlign:"left",width:"256px"},children:D.value}),e.jsx(Ke,{})]},Y))})]})})})},`order-row-total-${y.id}-${N}`))});const O={color:"white",whiteSpace:"nowrap",transition:"background-color 0.3s",fontWeight:"900",backgroundColor:"#263043","&:hover":{}};return s.data===null||s.data.length===0||r.length===0?e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%"},children:e.jsx(Se,{})}):e.jsxs(me,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",borderRadius:"lg",backgroundColor:"#263043"},children:[e.jsx(A,{children:e.jsx(fe,{sx:{padding:"0px",margin:"0px",width:"100%",backgroundColor:"#263043",color:"#efefef",borderRadius:"0px",display:c||S?"block":"none"}})}),e.jsxs(C,{direction:"row",sx:{backgroundColor:"#263043",padding:1,display:c||S?"none":"flex"},gap:1,children:[e.jsx(ge,{sx:{alignItems:"center",justifyContent:"center",backgroundColor:"#a33e23",display:S?"none":"flex",px:2},size:"sm",children:e.jsx("span",{style:{color:"white",fontWeight:"bold"},children:`Pending Payment : ₹${(d-u).toFixed(2)}`})}),e.jsx(ge,{sx:{alignItems:"center",justifyContent:"center",backgroundColor:"#0a6847",display:S?"none":"flex",px:2},size:"sm",children:e.jsx("span",{style:{color:"white",fontWeight:"bold"},children:`Payment Done : ₹${u}`})}),e.jsx(B,{sx:{flexGrow:1,backgroundColor:"transparent"}}),e.jsxs(C,{direction:"row",gap:1,children:[e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{color:"white",fontWeight:"bold"},children:"From:"})}),e.jsx(G,{placeholder:"Start Date",type:"date",name:"date",required:!0,size:"sm",value:L,onKeyDown:y=>{try{y.preventDefault()}catch(N){console.warn(N)}},onFocus:y=>{try{y.target.showPicker()}catch(N){console.warn(N)}},onClick:y=>{try{y.target.showPicker()}catch(N){console.warn(N)}},onChange:y=>{try{T(y.target.value)}catch(N){console.warn(N)}},sx:{width:"100%",flexGrow:1,backgroundColor:"#263043",color:"white",innerSpinnerColor:"white",colorScheme:"dark"}}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{style:{color:"white",fontWeight:"bold"},children:"To:"})}),e.jsx(G,{placeholder:"Start Date",type:"date",name:"date",required:!0,size:"sm",value:F,onKeyDown:y=>{try{y.preventDefault()}catch(N){console.warn(N)}},onFocus:y=>{try{y.target.showPicker()}catch(N){console.warn(N)}},onClick:y=>{try{y.target.showPicker()}catch(N){console.warn(N)}},onChange:y=>{try{p(y.target.value)}catch(N){console.warn(N)}},sx:{width:"100%",flexGrow:1,backgroundColor:"#263043",color:"white",innerSpinnerColor:"white",colorScheme:"dark"}})]}),e.jsx(Mo,{gaslistData:pt,plants:r})]}),e.jsx(A,{sx:{borderRadius:"lg",height:"100%",overflow:"auto",backgroundColor:"white"},children:e.jsx(A,{sx:{overflow:"auto"},children:e.jsxs(ye,{borderAxis:"bothBetween",color:"neutral",size:"md",stickyFooter:!1,stickyHeader:!0,stripe:"odd",variant:"soft",sx:{tableLayout:"auto",fontWeight:"bold"},children:[e.jsx("thead",{children:e.jsx("tr",{children:["Order No.","Date","Plant","Scheme Type","Scheme Rate","Gas","Qty","Total Kg","Rate","Total","Return Qty","Return Total Kg"].map((y,N)=>e.jsx("th",{style:O,children:y},N))})}),e.jsx("tbody",{children:k})]})})})]})}const he=({id:t,data:s,tableName:r,column:a,editable:n=!0})=>{const[o,i]=l.useState(!1),[m,S]=l.useState(s),v=pe(),c=()=>e.jsx(A,{sx:{color:"black",borderRadius:0,backgroundColor:"transparent",whiteSpace:"nowrap",transition:"background-color 0.3s",fontWeight:"bold",flexGrow:1,width:"100%",height:"100%","&:hover":{backgroundColor:n?"#c1ebd4":"transparent"},display:"flex",alignItems:"center",justifyContent:"center",borderLeftWidth:"0.1px",borderColor:a!=="pay_amt"?"#9cafbe":"transparent"},onClick:()=>{r!=""&&i(!0)},children:e.jsx("div",{style:{display:"flex",fontWeight:"bold"},children:s})}),E=s;let _=null;if(a==="gas_id"&&(_=E.id,s=`${s.company_name} : ${s.kg} KG`),a==="pay_amt"||a==="scheme"||a==="tcs"||a==="for_charges"||a==="defective_amount")return o?e.jsx(G,{sx:{color:"black",flexGrow:1},type:"number",value:m,onChange:d=>{S(d.target.value)},endDecorator:e.jsxs(C,{direction:"row",sx:{padding:0},children:[e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,m:0,transition:"all 0.3s",cursor:"pointer",color:"#b34349",borderRadius:"md","&:hover":{backgroundColor:"#b34349",color:"white"}},onClick:()=>{i(!1)},children:e.jsx(at,{})}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,m:0,transition:"all 0.3s",cursor:"pointer",color:"#0a6847",borderRadius:"md","&:hover":{backgroundColor:"#0a6847",color:"white"}},onClick:()=>{i(!1),r==="purchase_orders"&&v(ht(t,{[a]:m})),r==="purchase_order_items"&&v(_t(t,{[a]:m}))},children:e.jsx(ft,{})})]})}):e.jsx(A,{children:e.jsxs(C,{direction:"row",alignContent:"center",justifyContent:"center",alignItems:"center",sx:{width:"100%"},children:[e.jsx(c,{}),e.jsx(C,{sx:{color:"black",padding:1,borderRadius:"md","&:hover":{backgroundColor:"#a33e23",color:"white"}},direction:"row",onClick:()=>{i(!0)},children:e.jsx(Es,{style:{fontSize:"25px"}})})]})});if(!o)return e.jsx("td",{style:{borderWidth:0,padding:0,margin:0},children:e.jsx(c,{})});if(a==="gas_id")return e.jsx("td",{style:{padding:0,borderWidth:0,minWidth:"200px"},children:e.jsxs(C,{alignContent:"center",justifyContent:"center",alignItems:"center",direction:"row",sx:{width:"100%"},children:[e.jsx(Te,{defaultValue:E.id,size:"sm",sx:{flexGrow:1},onChange:(d,u)=>{_=u},children:pt.map(d=>{if(d.company_name==="GO GAS")return e.jsxs(Re,{value:d.id,children:[d.company_name," : ",d.kg," KG"]},d.id)})}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,m:0,transition:"all 0.3s",cursor:"pointer",color:"#b34349",borderRadius:"md","&:hover":{backgroundColor:"#b34349",color:"white"}},onClick:()=>{i(!1)},children:e.jsx(at,{})}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,m:0,transition:"all 0.3s",cursor:"pointer",color:"#0a6847",borderRadius:"md","&:hover":{backgroundColor:"#0a6847",color:"white"}},onClick:()=>{i(!1),v(_t(t,{[a]:_}))},children:e.jsx(ft,{})})]})});let x="text";switch(a){case"qty":x="number";break;case"rate":x="number";break;case"return_cyl_qty":x="number";break;case"date":x="date";break}return e.jsx("td",{style:{borderWidth:0,padding:0,margin:0},children:o?e.jsx(C,{direction:"row",sx:{width:"100%"},children:e.jsx(G,{sx:{color:"black",flexGrow:1},name:a,size:"sm",type:x,value:o?m:"",onChange:d=>{S(d.target.value)},endDecorator:e.jsxs(C,{direction:"row",sx:{padding:0},children:[e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,m:0,transition:"all 0.3s",cursor:"pointer",color:"#b34349",borderRadius:"md","&:hover":{backgroundColor:"#b34349",color:"white"}},onClick:()=>{i(!1)},children:e.jsx(at,{})}),e.jsx(A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,m:0,transition:"all 0.3s",cursor:"pointer",color:"#0a6847",borderRadius:"md","&:hover":{backgroundColor:"#0a6847",color:"white"}},onClick:()=>{i(!1),r==="purchase_orders"&&v(ht(t,{[a]:m})),r==="purchase_order_items"&&v(_t(t,{[a]:m}))},children:e.jsx(ft,{})})]})})}):e.jsx(c,{})})},Bo=({children:t,data:s,order:r})=>{const[a,n]=l.useState(!1),{kg:o,qty:i,amt:m,pay_amt:S,remaning_amt:v,rKg:c,rQty:E,defective_amount:_}=s,x=.5;return e.jsxs(me,{sx:{height:"auto",transition:`all ${x}s`,backgroundColor:a?"#D1E9F6":"transparent",borderTop:"1px solid #323b4d54",borderBottom:"1px solid #323b4d54"},children:[e.jsx(B,{orientation:"vertical"}),e.jsx(A,{sx:{transition:`all ${x}s`,maxHeight:a?"612px":"0px",opacity:a?1:0,transform:a?"scaleY(1)":"scaleY(0)"},children:t}),e.jsxs(C,{direction:"row",gap:1,sx:{opacity:.9,py:1,fontSize:"14px"},children:[e.jsx(qo,{order:r}),e.jsx(B,{sx:{flexGrow:1,backgroundColor:"transparent"},orientation:"vertical"}),e.jsxs(A,{sx:{fontWeight:"bold",display:a?"none":"flex",alignItems:"center",justifyContent:"flex-end",px:1,margin:a?1:0,transition:"all 0.3s",cursor:"pointer",borderRadius:"md",color:"#185ea5"},children:[e.jsxs("span",{style:{fontWeight:"bold"},children:["Total Qty : ",e.jsx("span",{style:{color:"#263043"},children:i})]}),e.jsx(B,{sx:{width:"2px",mx:1},orientation:"vertical"}),e.jsxs("span",{style:{fontWeight:"bold"},children:["Total Kg : ",e.jsx("span",{style:{color:"#263043"},children:o})]}),e.jsx(B,{sx:{width:"2px",mx:1},orientation:"vertical"}),e.jsxs("span",{style:{fontWeight:"bold"},children:["Total Amount : ",e.jsxs("span",{style:{color:"#263043"},children:["₹",m]})]}),e.jsx(B,{sx:{width:"2px",mx:1},orientation:"vertical"}),e.jsxs("span",{style:{fontWeight:"bold"},children:["Paid Amount : ",e.jsxs("span",{style:{color:"#263043"},children:["₹",S]})]}),e.jsx(B,{sx:{width:"2px",mx:1},orientation:"vertical"}),e.jsxs("span",{style:{fontWeight:"bold"},children:["Remainng Amount : ",e.jsxs("span",{style:{color:"#263043"},children:["₹",v]})]})]}),e.jsx(A,{sx:{fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"flex-end",px:1,margin:a?1:0,transition:"all 0.3s",cursor:"pointer",outline:a?"1px solid #C80036":"1px solid transparent",color:a?"#C80036":"#185ea5",borderRadius:"md","&:hover":{backgroundColor:a?"#F8EDED":"#12467b7a",color:a?"#C80036":"white"}},onClick:()=>n(!a),children:a?e.jsx(Zr,{}):e.jsx(ea,{})}),e.jsx(B,{sx:{width:"2px",opacity:0},orientation:"vertical"})]})]})},qo=({order:t})=>{const[s,r]=le.useState(!1),a=pe(),[n,o]=l.useState(0),[i,m]=l.useState(0),[S,v]=l.useState(0),[c,E]=l.useState(0);let _=0;try{_=xt.get(n).kg*i}catch{_=0}let x=i*S;return e.jsxs(le.Fragment,{children:[" ",e.jsxs(A,{sx:{fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"flex-end",px:1,ms:0,transition:"all 0.3s",cursor:"pointer",color:"#185ea5",borderRadius:"md","&:hover":{backgroundColor:"#12467b7a",color:"white"}},onClick:()=>{r(!0)},children:[" ",e.jsx(Es,{})," Edit"]}),e.jsxs(A,{sx:{fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"flex-end",px:1,m:0,transition:"all 0.3s",cursor:"pointer",color:t.cleared?"white":"#185ea5",backgroundColor:t.cleared?"#0a6847":"transparent",borderRadius:"md","&:hover":{backgroundColor:"#12467b7a",color:"white"}},onClick:()=>{prompt(`Type Order No.: ${t.order_no} to ${t.cleared?"Unclear":"Clear"}`,"")===t.order_no?a(ht(t.id,{cleared:!t.cleared})):alert("Invalid Order No.")},children:[" ",t.cleared?e.jsxs(e.Fragment,{children:[e.jsx(Yt,{})," Cleared"]}):e.jsxs(e.Fragment,{children:[e.jsx(Yt,{})," Mark Cleared"]})]}),e.jsx(ve,{to:"/admin/report",state:{orderId:t.id,orderNo:t.order_no,orderDate:t.date},children:e.jsxs(A,{sx:{fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"flex-end",px:1,ms:0,transition:"all 0.3s",cursor:"pointer",color:"#185ea5",borderRadius:"md","&:hover":{backgroundColor:"#12467b7a",color:"white"}},onClick:()=>{},children:[" ",e.jsx(ta,{})," Print"]})}),e.jsx(Ne,{"aria-labelledby":"modal-title-12","aria-describedby":"modal-desc",open:s,sx:{borderWidth:"0px",backgroundColor:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},onClose:()=>r(!1),children:e.jsxs(me,{sx:{borderRadius:"md",p:3,boxShadow:"lg"},children:[e.jsx(ke,{variant:"plain",sx:{m:1}}),e.jsxs(C,{direction:"row",gap:1,alignContent:"center",mb:1,children:[e.jsx(ue,{component:"h2",id:"modal-title",level:"h4",textColor:"inherit",fontWeight:"lg",mx:1,children:`Order No. ${t.order_no}`}),e.jsx($,{variant:"soft",startDecorator:e.jsx(sa,{}),color:"danger",onClick:()=>{prompt("Type Order No. to delete","")===t.order_no&&a(bn(t.id)),r(!1)},children:"Delete"})]}),e.jsx("form",{onSubmit:d=>{d.preventDefault();const u=new FormData(d.currentTarget),L=Object.fromEntries(u.entries());L.order_id=t.id,a(Oo(L)),r(!1)},children:e.jsxs(ye,{sx:{tableLayout:"auto",fontWeight:"bold"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Gas                         "}),e.jsx("th",{children:"Qty."}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Total Kg"}),e.jsx("th",{children:"Total Amt"}),e.jsx("th",{children:"Return Qty"}),e.jsx("th",{children:"Option"})]})}),e.jsx("tbody",{children:t.items.map((d,u)=>{const L=xt.get(d.gas_id);return e.jsxs("tr",{children:[e.jsx("td",{children:`${L.company_name} : ${L.kg} KG`}),e.jsx("td",{children:d.qty}),e.jsx("td",{children:d.rate}),e.jsx("td",{children:L.kg*d.qty}),e.jsx("td",{children:d.qty*d.rate}),e.jsx("td",{children:d.return_cyl_qty}),e.jsx("td",{children:e.jsx($,{variant:"outlined",color:"danger",sx:{width:"100%"},onClick:()=>{confirm("Are you sure you want to delete this item?")&&a(Wo(d.id))},children:e.jsx(vs,{})})})]},u)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(Te,{placeholder:"select Gas",name:"gas_id",required:!0,onChange:(d,u)=>{o(u)},children:pt.map(d=>{if(d.company_name==="GO GAS")return e.jsx(Re,{value:d.id,label:`${d.company_name} : ${d.kg} KG`,children:`${d.company_name} : ${d.kg} KG`},d.id)})})}),e.jsx("td",{children:e.jsx(G,{placeholder:"Qty",type:"number",name:"qty",required:!0,onChange:d=>m(d.target.value)})}),e.jsx("td",{children:e.jsx(G,{placeholder:"Rate",type:"number",name:"rate",required:!0,onChange:d=>v(d.target.value)})}),e.jsx("td",{children:_}),e.jsx("td",{children:x}),e.jsx("td",{children:e.jsx(G,{placeholder:"Return Qty",type:"number",name:"return_cyl_qty",value:c,required:!0,onChange:d=>{if(console.log(d.target.value,i,"changing"),console.log(Number(d.target.value),Number(i)),Number(i)<Number(d.target.value)){alert("Return Qty can't be more than Qty");return}E(d.target.value),console.log(d.target.value,"setting")}})}),e.jsx("td",{children:e.jsx($,{type:"submit",color:"success",sx:{width:"100%"},children:e.jsx(ra,{})})})]})})]})})]})})]})},Ho="CUSTOMER_INIT_STATE",Cr="CUSTOMER_FETCH_REQUEST",vr="CUSTOMER_FETCH_SUCCESS",Er="CUSTOMER_FETCH_FAILURE",Ko=()=>({type:Cr}),Qo=t=>({type:vr,payload:t}),Vo=t=>({type:Er,payload:t}),zo=K+"api/customers",Yo=()=>async t=>{t(Ko());try{const r=(await ee().get(zo)).data;t(Qo(r))}catch(s){console.log("customer : ",s),t(Vo(s))}},Jo="REPORT_INIT_STATE",_r="REPORT_FETCH_REQUEST",Dr="REPORT_FETCH_SUCCESS",Nr="REPORT_FETCH_FAILURE",Xo=()=>({type:_r}),Zo=t=>({type:Dr,payload:t}),el=t=>({type:Nr,payload:t}),tl=K+"api/report",sl=t=>(console.log("report params : ",t),async s=>{s(Xo());try{const a=(await ee().get(tl,{params:t})).data;s(Zo(a))}catch(r){console.log("report : ",r),s(el(r))}}),kr=xe({name:"bill",initialState:{isBillLoading:!1,isBillError:!1,billErrorMessage:"",isBillSuccess:!1},reducers:{billLoading:t=>{t.isBillLoading=!0,t.isBillError=!1,t.isBillSuccess=!1},billSuccess:t=>{t.isBillLoading=!1,t.isBillError=!1,t.isBillSuccess=!0},billError:(t,s)=>{t.isBillLoading=!1,t.isBillError=!0,t.billErrorMessage=s.payload,t.isBillSuccess=!1},billReset:t=>{t.isBillLoading=!1,t.isBillError=!1,t.billErrorMessage="",t.isBillSuccess=!1}}}),rl=(t,s,r)=>async a=>{const n=il(t);a(al());try{const o=await ee().post("sendBillSms",{link:n,customerNumber:s,amount:r});a(nl())}catch(o){console.log(o),a(ol(o.message||"Failed to send bill"))}},{billLoading:al,billSuccess:nl,billError:ol,billReset:Ri}=kr.actions,ll=kr.reducer,il=t=>{const s=t.replace(/^http:\/\//,""),[r,a]=s.split("?");if(!a)return s;const n=new URLSearchParams(a);return n.set("p","1"),`${r}?${n.toString()}`},Dt="customer",cl="delivery",Nt="purchase",gs=({isLogged:t})=>{const s=window.location.href,r=s.indexOf("#"),a=s.substring(r+1),n=new URL(a,window.location.origin),o=new URLSearchParams(n.search),m=ja().state,S=l.useRef(),v=ks.useReactToPrint({contentRef:S}),c=async q=>{if(!q?.current){alert("No content to download");return}try{const te=q.current;if(!te.offsetParent)throw new Error("Element is not visible or not in DOM");const f={margin:10,filename:`bill_${new Date().toISOString().slice(0,10).replace(/-/g,"-")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:window.devicePixelRatio||2,useCORS:!0,scrollX:0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};await Na().set(f).from(te).save()}catch(te){console.error("Error generating PDF:",te),alert("Error generating PDF. Please try again.")}};console.log(m);const[E,_]=le.useState(()=>m?.orderId?Nt:Dt),x=pe(),{customersLoading:d,customers:u,customersError:L}=J(q=>q.customer),{reportLoading:T,report:F,reportError:p}=J(q=>q.reports),{isBillLoading:k,isBillError:O,isBillSuccess:y,billErrorMessage:N}=J(q=>q.bill);console.log("BILL",k,O,y,N),y&&alert("Bill sent successfully");const V=()=>{const[q,te]=le.useState(Number(o.get("customer"))||null),[z,oe]=le.useState(()=>{if(o.get("start_date"))return o.get("start_date");{const h=new Date;return new Date(h.getFullYear(),h.getMonth(),1).toLocaleDateString("en-GB").split("/").reverse().join("-")}}),[f,M]=le.useState(()=>{if(o.get("end_date"))return o.get("end_date");{const h=new Date;return new Date(h.getFullYear(),h.getMonth()+1,0).toLocaleDateString("en-GB").split("/").reverse().join("-")}}),[j,U]=l.useState(!1),I=()=>{if(console.log(q,z,f),q==null||z===void 0||z===null||!fs(z)||f===void 0||f===null||!fs(f)){alert("Please select valid customer and date range");return}let h=window.location.href;h=h.split("?")[0],h=h+`?customer=${q}&start_date=${z}&end_date=${f}&p=2`,window.location.href=h,x(sl({customer:q,startDate:z,endDate:f}))};l.useEffect(()=>{u.length===0&&!d&&x(Yo());try{const h=Number(o.get("p"));console.log(F===null),h===1&&I()}catch(h){console.log(h)}},[]);let P=0,g=0,R=0,Q=0;return e.jsxs(C,{sx:{padding:1,flexGrow:1,flexDirection:{xs:"column",md:"row"}},gap:1,children:[e.jsxs(C,{gap:1,sx:{display:t?"block":"none",width:{xs:"100%",md:"auto"},minWidth:{xs:"100%",md:"350px"}},children:[e.jsx(C,{children:e.jsxs(C,{gap:1,direction:"row",alignContent:"center",alignItems:"center",sx:{flexDirection:{xs:"column",md:"row"},width:"100%"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"black",width:{xs:"100%",md:"auto"}},children:"Customer : "}),e.jsx(Te,{placeholder:"Select User",variant:"outlined",sx:{width:"100%",minWidth:{xs:"100%",md:"200px"}},onChange:(h,w)=>{te(w)},defaultValue:q,children:u.map((h,w)=>e.jsxs(Re,{value:h.id,children:[h.user.name," : ",e.jsxs("span",{children:[" ",h.user.address]})]},w+"payment_option"))})]})}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1}}),e.jsxs(C,{gap:2,children:[e.jsxs(C,{gap:1,sx:{flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"}},children:[e.jsxs("span",{style:{fontWeight:"bold",color:"black",minWidth:{xs:"100%",md:"auto"},wordBreak:"keep-all",whiteSpace:"nowrap"},children:[e.jsx("span",{children:"Date"}),e.jsx("span",{children:" "}),e.jsx("span",{children:"Start"}),e.jsx("span",{children:":"})]}),e.jsx(G,{type:"date",sx:{width:"100%"},onChange:h=>{oe(h.target.value)},defaultValue:z})]}),e.jsxs(C,{gap:1,sx:{flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"}},children:[e.jsx("span",{style:{fontWeight:"bold",color:"black",minWidth:{xs:"100%",md:"auto"},whiteSpace:"nowrap"},children:"End Date :"}),e.jsx(G,{type:"date",sx:{width:"100%"},onChange:h=>{M(h.target.value)},defaultValue:f})]}),e.jsxs(C,{gap:1,sx:{flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"}},children:[e.jsx("span",{style:{fontWeight:"bold",color:"black",minWidth:{xs:"100%",md:"auto"},whiteSpace:"nowrap"},children:"New Connections :"}),e.jsx(It,{label:"",size:"lg",checked:j,onChange:h=>{U(h.target.checked)}})]})]}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1}}),e.jsx($,{variant:"contained",sx:{backgroundColor:"#263043",color:"white",width:"100%"},onClick:()=>I(),children:"OK"})]}),e.jsx(B,{orientation:"vertical",sx:{m:1,backgroundColor:"#979797",display:{xs:"none",md:t?"block":"none"}}}),e.jsxs(C,{sx:{overflow:"auto",width:{xs:"100%",md:"auto"},flexGrow:1},children:[e.jsxs(C,{sx:{padding:{xs:1,md:4},m:{xs:0,md:2},overflow:"auto",flexGrow:1,height:"100%",alignItems:"stretch",border:"1px solid #979797","@media print":{overflow:"visible",height:"auto",border:"none"}},direction:"column",ref:S,children:[e.jsx(Tr,{}),F?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:`Customer : ${F.customer.user.name}`}),e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:`Address : ${F.customer.user.address}`}),e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:`Phone No. : ${F.customer.user.phone_no}`}),e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:`Bill Date Range : ${z} to ${f}`}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1}}),e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:"Delivered Gas List"}),e.jsxs(ye,{borderAxis:"both",size:"sm",variant:"outlined",sx:{width:"100%",mt:1,tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Delivery Date"}),e.jsx("th",{children:"Delivery By"}),e.jsx("th",{children:"Gas"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Total"})]})}),e.jsxs("tbody",{children:[F.customer.new_connection.map((h,w)=>((h.gas_id!==null||h.gas_id!==void 0||h.gas_id!=="")&&(P+=h.gas_price*h.gas_qty),(h.accessorie_id!==null||h.accessorie_id!==void 0||h.accessorie_id!=="")&&(P+=h.accessorie_price),e.jsxs("tr",{style:{display:j?"":"none"},children:[e.jsx("td",{className:"b",children:kt(h.created_at)}),e.jsx("td",{className:"b",children:"Office"}),e.jsxs("td",{className:"b",children:[h.gas_id?`${h.gas.company_name} : ${h.gas.kg}KG`:h.accessorie," ",e.jsx("span",{style:{color:"blue"},children:"New"})]}),e.jsx("td",{className:"b",children:h.gas_id?h.gas_qty:1}),e.jsx("td",{className:"b",children:h.gas_id?h.gas_price:h.accessorie_price}),e.jsx("td",{className:"b",children:h.gas_id?h.gas_price*h.gas_qty:h.accessorie_price})]},w+"new_connection"))),F.deliveries.map((h,w)=>{if(h.cleared)return;let b=0,D=0,Y="";console.log(h.payments),h.payments.forEach(W=>{g+=W.amount,W.method==0?D+=W.amount:b+=W.amount,Y=kt(W.created_at)}),console.log(Y);let re=[];if(h.gas_deliveries.map((W,ie)=>{let Z=W.price*W.quantity;P+=Z,W.is_empty?Q+=W.quantity:R+=W.quantity,re.push(e.jsxs("tr",{children:[e.jsx("td",{className:"b",children:kt(h.created_at)}),e.jsx("td",{className:"b",children:F.courierBoy.find(ce=>ce.id===h.courier_boy_id).username}),e.jsxs("td",{className:"b",children:[W.gas_cylinder.company_name," : ",W.gas_cylinder.kg,"KG ",e.jsx("span",{style:{color:W.is_empty?"#AF1740":"green"},children:W.is_empty?"Recived":"Delivered"})]}),e.jsx("td",{className:"b",children:W.quantity}),e.jsx("td",{className:"b",children:W.is_empty?"-":`₹${W.price}`}),e.jsx("td",{className:"b",style:{color:"#292b76"},children:W.is_empty?"-":`₹${Z}`})]},ie+"report_td"+W.id))}),b>0||D>0){let W=!1;b>0&&D>0&&(W=!0),re.push(e.jsxs("tr",{children:[e.jsx("td",{className:"b",children:Y}),b>0?e.jsxs("td",{className:"b",colSpan:W?0:4,children:["Online Payment : ₹",H(b)]}):e.jsx(e.Fragment,{}),D>0?e.jsxs("td",{className:"b",colSpan:W?3:4,children:["Cash Payment : ₹",H(D)]}):e.jsx(e.Fragment,{}),e.jsxs("td",{className:"b",style:{color:"#0A6847"},children:["-₹",H(b+D)]})]},w+"report_tdpayment"))}return re})]})]}),e.jsx("span",{style:{fontWeight:"bold",color:"black",marginTop:8},children:`Total Received Gas Quantity : ${R}`}),e.jsx("span",{style:{fontWeight:"bold",color:"black"},children:`Total Pending Gas Quantity : ${Q}`}),e.jsx("span",{style:{fontWeight:"bold",color:"black",marginTop:8},children:`Grand Total : ${P}₹`}),e.jsx("span",{style:{fontWeight:"bold",color:"#0A6847"},children:`Total Paid : ${g}₹`}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1,opacity:.5}}),e.jsx("span",{style:{fontWeight:"bold",color:"#A0153E"},children:`Total Remaining : ${P-g}₹`}),e.jsx("span",{style:{fontWeight:"bold",color:"black"}}),e.jsx(Rr,{})]}):e.jsx(e.Fragment,{children:t?"Select customer and date range to view report":e.jsx($,{onClick:()=>{let h=window.location.href;h=h.slice(0,-1)+"1",window.location.href=h},children:"Refresh"})}),e.jsx(A,{sx:{width:"100%",display:"flex",justifyContent:"end"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:t?"end":"center",padding:"8px"},children:[t?e.jsx(e.Fragment,{children:e.jsx($,{onClick:()=>{if(!F||!F.customer){alert("Please select a customer and generate report first");return}const h=window.location.href,w=P-g;x(rl(h,"917984847918",w.toString()))},sx:{width:{xs:"100%",md:"auto"}},children:k?e.jsx(Se,{}):"Send Bill To Customer"})}):e.jsx(e.Fragment,{}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1,opacity:.5}}),e.jsx($,{onClick:()=>{v()},sx:{width:{xs:"100%",md:"auto"}},children:"Print Bill"}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1,opacity:.5}}),e.jsx($,{onClick:()=>{c(S)},sx:{width:{xs:"100%",md:"auto"}},children:"Download Bill"})]})]})]})},X=()=>e.jsx(C,{sx:{width:"100%",height:"100%"},children:"Delivery reports"}),ne=()=>{const[q,te]=l.useState(!1),z=J(b=>b.gas),{plants:oe,plantsLoading:f,plantsError:M,plantsUpdateSuccess:j}=J(b=>b.plants),{orders:U,loading:I,error:P}=J(b=>b.purchaseOrders),[g,R]=l.useState(()=>{try{if(m.orderDate){const[re,W,ie]=m.orderDate.split("-"),ce=new Date(Date.UTC(ie,W-1,re)).toISOString().slice(0,10);return console.log(ce),ce}}catch(re){console.warn(re)}const b=new Date,Y=new Date(b.getFullYear(),b.getMonth(),1).toLocaleDateString("en-GB").split("/").reverse().join("-");return console.log(Y),Y}),[Q,h]=l.useState(()=>{try{if(m.orderDate){const[re,W,ie]=m.orderDate.split("-"),ce=new Date(Date.UTC(ie,W,0)).toISOString().slice(0,10);return console.log(ce),ce}}catch(re){console.warn(re)}const b=new Date;return new Date(b.getFullYear(),b.getMonth()+1,0).toLocaleDateString("en-GB").split("/").reverse().join("-")});l.useEffect(()=>{U.length===0&&x(ut({startDate:g,endDate:Q})),oe.length===0&&x(At()),z.data===null&&x(De())},[x,g,Q]);const w=()=>{x(ut({startDate:g,endDate:Q}))};return e.jsxs(C,{sx:{width:"100%",height:"100%"},direction:"row",gap:1,children:[e.jsx(me,{children:e.jsxs(C,{gap:1,children:[e.jsx(G,{startDecorator:e.jsx("pre",{children:"From:"}),placeholder:"Start Date",type:"date",name:"date",value:g,onKeyDown:b=>{try{b.preventDefault()}catch(D){console.warn(D)}},onFocus:b=>{try{b.target.showPicker()}catch(D){console.warn(D)}},onClick:b=>{try{b.target.showPicker()}catch(D){console.warn(D)}},onChange:b=>{try{R(b.target.value)}catch(D){console.warn(D)}}}),e.jsx(G,{startDecorator:e.jsx("pre",{children:"To:"}),placeholder:"End Date",type:"date",name:"date",value:Q,onKeyDown:b=>{try{b.preventDefault()}catch(D){console.warn(D)}},onFocus:b=>{try{b.target.showPicker()}catch(D){console.warn(D)}},onClick:b=>{try{b.target.showPicker()}catch(D){console.warn(D)}},onChange:b=>{try{h(b.target.value)}catch(D){console.warn(D)}}}),e.jsx($,{variant:"contained",sx:{backgroundColor:"#263043",color:"white",width:"100%"},onClick:()=>w(),children:"OK"})]})}),e.jsx(B,{orientation:"vertical",sx:{m:1,backgroundColor:"#979797"}}),e.jsx(me,{sx:{flexGrow:1},children:e.jsxs(C,{children:[e.jsx(fe,{sx:{display:I||f?"block":"none"}}),!I&&!f&&z.data!=null&&oe.length>0?e.jsx(e.Fragment,{children:e.jsx(dl,{orders:U,allGas:z.data,plants:oe,showBreakdown:q,setShowBreakdown:te})}):e.jsx("pre",{children:"Loading"})]})})]})};return e.jsxs(C,{sx:{height:"100%",width:"100%",borderRadius:"16px",backgroundColor:"white",padding:1,flexGrow:1,overflow:"auto"},children:[e.jsx(A,{children:e.jsx(fe,{sx:{display:T||d?"block":"none"}})}),e.jsxs(C,{sx:{display:t?"flex":"none",flexDirection:"row",gap:1},children:[e.jsx($,{variant:"soft",onClick:()=>_(Dt),children:"Customer"}),e.jsx($,{variant:"soft",onClick:()=>_(Nt),children:"Purchase"})]}),e.jsx(B,{sx:{m:1,backgroundColor:"#979797",display:t?"block":"none"}}),E===Dt&&e.jsx(V,{}),E===cl&&e.jsx(X,{}),E===Nt&&e.jsx(ne,{})]})};function fs(t){return t.match(/^\d{4}-\d{2}-\d{2}$/)}function kt(t){return new Date(t).toLocaleDateString("en-GB").split("/").reverse().join("-")}function dl({orders:t,allGas:s,plants:r,showBreakdown:a,setShowBreakdown:n}){const o=l.useRef(),i=ks.useReactToPrint({contentRef:o}),[m,S]=le.useState(null);let v=0,c=0,E=[];return t.forEach((_,x)=>{console.log(_);const d=_.order_no,u=_.date,L=r.filter(j=>j.id===_.plant_id)[0].name,T=_.scheme_type,F=_.scheme,p=_.defective_amount,k=_.tcs,O=_.for_charges,y=_.pay_amt;let N=0,V=0,X=0,ne=0,q=0;_.items.forEach((j,U)=>{const I=s.data.filter(b=>b.id===j.gas_id)[0],P=j.qty,g=j.rate,R=I.kg*P,Q=R*g,h=j.return_cyl_qty,w=I.kg*h;N+=R,V+=P,ne+=h,X+=w,q+=Q,E.push(e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"b",children:d}),e.jsx("td",{className:"b",children:u}),e.jsx("td",{className:"b",colSpan:2,children:L}),e.jsx("td",{className:"b",children:T}),e.jsx("td",{className:"b",children:I.kg+" KG"}),e.jsx("td",{className:"b",children:P}),e.jsx("td",{className:"b",children:R}),e.jsx("td",{className:"b",children:"₹"+H(g)}),e.jsx("td",{className:"b",children:"₹"+H(Q)}),e.jsx("td",{className:"b",children:h}),e.jsx("td",{className:"b",children:w})]},x+"_"+U+"order_item")}))});const te=F*N,z=k*q,oe=O*N,f=q+z+oe-te-p,M=f-y;v+=q,c+=y,a&&E.push(e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsxs("td",{className:"b",colSpan:2,children:["Total Qty : ",V]}),e.jsxs("td",{className:"b",colSpan:2,children:["Total Kg : ",N]}),e.jsxs("td",{className:"b",colSpan:2,children:["Total MT Qty : ",ne]}),e.jsxs("td",{className:"b",colSpan:2,children:["Total MT Kg : ",X]})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"b",colSpan:2,children:["Scheme Rate : ₹",H(k)]}),e.jsxs("td",{className:"b",colSpan:2,children:["Scheme Total: ₹",H(te)]}),e.jsxs("td",{className:"b",colSpan:2,children:["TCS : ₹",H(k)]}),e.jsxs("td",{className:"b",colSpan:2,children:["TCS Total ₹",H(z)]}),e.jsxs("td",{className:"b",colSpan:2,children:["FOR : ₹",H(O)]}),e.jsxs("td",{className:"b",colSpan:2,children:["FOR TOTAL ₹",H(oe)]})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"b",colSpan:2,children:["Defective : ₹",H(p)]}),e.jsxs("td",{className:"b",colSpan:2,children:["TOTAL ₹",H(f)]}),e.jsxs("td",{className:"b",colSpan:2,children:["PAID ₹",H(y)]}),e.jsxs("td",{className:"b",colSpan:2,children:["BAL ₹",H(M)]})]})]})),E.push(e.jsx("tr",{children:e.jsx("td",{className:"b",colSpan:12})}))}),E.push(e.jsxs(e.Fragment,{children:[e.jsx("tr",{children:e.jsxs("td",{className:"b",colSpan:12,children:["Grand Total Amount : ",H(v)]})}),e.jsx("tr",{children:e.jsxs("td",{className:"b",colSpan:12,children:["Grand Total Paid : ",H(c)]})}),e.jsx("tr",{children:e.jsxs("td",{className:"b",colSpan:12,children:["Grand Total Balance : ",H(v-c)]})})]})),e.jsx(C,{direction:"column",gap:1,children:e.jsxs(C,{direction:"column",gap:1,children:[e.jsxs(C,{direction:"row",gap:1,children:[e.jsx(_e,{variant:"soft",color:"primary",sx:{cursor:"pointer",transition:"all 0.3s","&:hover":{backgroundColor:"#c7dff7"},display:"flex",alignItems:"center",justifyContent:"center",height:"42px"},onClick:()=>{S(null)},children:e.jsx(aa,{})}),e.jsx(_e,{variant:"solid",color:"primary",sx:{cursor:"pointer",transition:"all 0.3s","&:hover":{backgroundColor:"#c7dff7"},display:"flex",alignItems:"center",justifyContent:"center",height:"42px"},onClick:()=>{i()},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Print"})}),e.jsx(B,{sx:{flexGrow:1,opacity:0}}),e.jsx(_e,{variant:"solid",color:"primary",sx:{cursor:"pointer",transition:"all 0.3s","&:hover":{backgroundColor:"#c7dff7"},display:"flex",alignItems:"center",justifyContent:"center",height:"42px"},onClick:()=>{n(!a)},children:e.jsx("span",{style:{fontWeight:"bold"},children:"Breakdown"})})]}),e.jsxs(C,{direction:"column",gap:1,ref:o,sx:{p:1,m:1,borderRadius:"sm",border:"1px solid #979797"},children:[e.jsx(Tr,{}),e.jsxs(ye,{borderAxis:"both",size:"sm",variant:"outlined",sx:{width:"100%",mt:1,tableLayout:"auto","& th":{fontWeight:"bold",color:"black"},"& td":{fontWeight:"bold",color:"black",wordBreak:"keep-all"}},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order No."}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{colSpan:2,children:"Plant"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Gas"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Total Kg"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"MT Qty"}),e.jsx("th",{children:"Total MT Kg"})]})}),e.jsx("tbody",{children:E})]}),e.jsx(Rr,{})]})]})})}function Tr(){return e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontWeight:"bold",color:"black",fontSize:"xx-large",textAlign:"center"},children:"SHREE RAM DISTRIBUTORS"}),e.jsx("span",{style:{color:"black",textAlign:"center"},children:e.jsxs("i",{children:["Address:SHREE RAM DISTRIBUTOR SHOP NO. 3 OPP ESSAR PUMP , NEAR DADRA GARDEN VAPI SILVASSA ROAD DADRA , DADRA NAGAR HAVELI (U.T.), ",e.jsx("br",{})," Phone: +917984240723, Email : jitenrpande@gmail.com"]})}),e.jsx(B,{sx:{backgroundColor:"#979797",m:1}})]})}function Rr(){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"end",alignItems:"center",marginTop:"20px"},children:e.jsx("img",{style:{margin:"10px",zIndex:99,height:"100px",width:"100px",rotate:"-45deg"},src:"stamp.png"})})})}const ul=t=>(t.data.forEach(s=>{s.forEach((r,a)=>{r==0&&(s[a]="")})}),e.jsx(ka,{data:t.data,headers:t.headers,filename:t.filename,target:"_blank",className:"inline-block px-4 py-2 ms-1 hover:bg-blue-700 hover:text-white text-black rounded-md transition duration-200 font-bold",children:t.children?t.children:"Download"})),Ir=xe({name:"customerPaymentsUpdateOrCreate",initialState:{isCustomerPaymentsUpdateOrCreateLoading:!1,isCustomerPaymentsUpdateOrCreateError:!1,customerPaymentsUpdateOrCreateErrorMessage:"",isCustomerPaymentsUpdateOrCreateSuccess:!1},reducers:{customerPaymentsUpdateOrCreateLoading:t=>{t.isCustomerPaymentsUpdateOrCreateLoading=!0,t.isCustomerPaymentsUpdateOrCreateError=!1,t.isCustomerPaymentsUpdateOrCreateSuccess=!1},customerPaymentsUpdateOrCreateSuccess:t=>{t.isCustomerPaymentsUpdateOrCreateLoading=!1,t.isCustomerPaymentsUpdateOrCreateError=!1,t.isCustomerPaymentsUpdateOrCreateSuccess=!0},customerPaymentsUpdateOrCreateError:(t,s)=>{t.isCustomerPaymentsUpdateOrCreateLoading=!1,t.isCustomerPaymentsUpdateOrCreateError=!0,t.customerPaymentsUpdateOrCreateErrorMessage=s.payload,t.isCustomerPaymentsUpdateOrCreateSuccess=!1},customerPaymentsUpdateOrCreateReset:t=>{t.isCustomerPaymentsUpdateOrCreateLoading=!1,t.isCustomerPaymentsUpdateOrCreateError=!1,t.customerPaymentsUpdateOrCreateErrorMessage="",t.isCustomerPaymentsUpdateOrCreateSuccess=!1}}}),hl=t=>async s=>{s(ml());try{const r=await ee().post(Oa,t);console.log(r.data),s(pl())}catch(r){console.log(r),s(xl(r.message||"Failed to update or create customer payments"))}},{customerPaymentsUpdateOrCreateLoading:ml,customerPaymentsUpdateOrCreateSuccess:pl,customerPaymentsUpdateOrCreateError:xl,customerPaymentsUpdateOrCreateReset:Ii}=Ir.actions,gl=Ir.reducer,se={WHITE:"#ffffff",KG_4:"#fde3e3",KG_12:"#e3f2fd",KG_15:"#e8f5e9",KG_17:"#fff3e0",KG_21:"#f3e5f5"},it=[{column:"date",color:se.WHITE},{column:"customer",color:se.WHITE},{column:"4kg cyl",color:se.KG_4},{column:"mt",color:se.KG_4},{column:"rate",color:se.KG_4},{column:"total",color:se.KG_4},{column:"12kg cyl",color:se.KG_12},{column:"mt",color:se.KG_12},{column:"rate",color:se.KG_12},{column:"total",color:se.KG_12},{column:"15kg cyl",color:se.KG_15},{column:"mt",color:se.KG_15},{column:"rate",color:se.KG_15},{column:"total",color:se.KG_15},{column:"21kg cyl",color:se.KG_21},{column:"mt",color:se.KG_21},{column:"rate",color:se.KG_21},{column:"total",color:se.KG_21},{column:"sub total",color:se.WHITE},{column:"received",color:se.WHITE},{column:"balance",color:se.WHITE}],Lt=[];let Ft=new Map,Ut=[];function fl(){const t=pe(),{deliveries:s,loading:r,updateSuccess:a,error:n}=J(g=>g.deliverys),{userDataLoading:o,users:i,userDataError:m}=J(g=>g.user),S=J(g=>g.gas),{gasDeliverysSucsess:v}=J(g=>g.gasDelivery);if(Ut.length=0,Ft.clear(),S.data!=null&&S.data.data.forEach(g=>{Ft.set(g.id,g),Ut.push(e.jsxs(Re,{value:g.id,children:[g.company_name," - ",g.kg,"KG"]},g.id))}),Lt.length=0,i!=null&&i!=null){const g=i.map(R=>{if(R.customers.length==0)return null;const Q=R.customers[0]?.id,h=Me(R.name),w=Me(R.address);return{id:Q,label:`${h} (${w})`}}).filter(Boolean);Lt.push(...g)}const c=window.location.href,E=c.indexOf("#"),_=c.substring(E+1),x=new URL(_,window.location.origin),d=new URLSearchParams(x.search),u=d.get("customerId"),L=d.get("deliverBoyId"),T=d.get("dateStart"),F=d.get("dateEnd");let p=u?Number(u):null,k=L?Number(L):null;const[O,y]=l.useState(p),[N,V]=l.useState(k),X=g=>{q(g),M(g,z,O,N)},[ne,q]=l.useState(()=>st(T?new Date(T):new Date(new Date().getFullYear(),new Date().getMonth(),1))),te=g=>{oe(g),M(ne,g,O,N)},[z,oe]=l.useState(()=>{if(F)return st(new Date(F));let g=new Date(new Date().getFullYear(),new Date().getMonth()+1,0);return st(g)}),f=(g=!1)=>{g?t(us({dateStart:ne,dateEnd:z,customer_id:O,courier_boy_id:N})):(s==null||s==null)&&r==!1&&t(us({dateStart:ne,dateEnd:z,customer_id:O,courier_boy_id:N}))},M=(g,R,Q,h)=>{const w=window.location.hash.substring(1),[b,D=""]=w.split("?"),Y=new URLSearchParams(D);Object.entries({dateStart:g,dateEnd:R,customerId:Q,deliverBoyId:h}).forEach(([ie,Z])=>{Z==null||Z===""?Y.delete(ie):Y.set(ie,Z)});const W=b+(Y.toString()?`?${Y}`:"");`#${W}`!==window.location.hash&&window.location.replace(window.location.pathname+window.location.search+`#${W}`)};M(ne,z,O,N),l.useEffect(()=>{f(),o===!1&&(i==null||i==null)&&r==!1&&(console.log("fetchUser..."),t(ao())),!S.isError&&!S.isLoading&&!r&&!o&&(S.data==null||S.data.data.length===0)&&(console.log("fetchGasData..."),t(De()))}),l.useEffect(()=>{Je.listenDataChange(()=>{r===!1&&(console.log("fetchDeliveries...Fire"),f(!0))})},[]),console.log(v,a),v&&(t({type:or}),f(!0)),a&&(t({type:Vs}),f(!0));function j(g,R,Q,h,w,b,D,Y){const re=rt(h.cylinders,h.mt,h.rate),W=rt(w.cylinders,w.mt,w.rate),ie=rt(b.cylinders,b.mt,b.rate),Z=rt(D.cylinders,D.mt,D.rate),ce=W.total+ie.total+Z.total;return{date:g,customer:R.customer,info:R,gasInfo:Q,kg4:re,kg12:W,kg15:ie,kg21:Z,subTotal:ce,received:Y}}let U=[],I=[];(s!=null||s!=null)&&(s.noData||(U=s.map(g=>{let R=0,Q=0,h=0,w=0,b=0,D=0,Y=0,re=0,W=0,ie=0,Z=0,ce=0,Ie=0,Ae=0;g.payments.forEach(ae=>{ae.method==0?R+=ae.amount:Q+=ae.amount});const et=g.gas_deliveries.map(ae=>(ae.kg==4&&(ae.is_empty?w+=ae.quantity:(h=ae.quantity,b=ae.gas_price)),ae.kg==12&&(ae.is_empty?Y+=ae.quantity:(D=ae.quantity,re=ae.gas_price)),ae.kg==15&&(ae.is_empty?ie+=ae.quantity:(W=ae.quantity,Z=ae.gas_price)),ae.kg==21&&(ae.is_empty?Ie+=ae.quantity:(ce=ae.quantity,Ae=ae.gas_price)),{cylinder:ae.brand,qty:ae.quantity,kg:15})),Ce=wl(g.created_at);let Le=h*b,$e=D*re,tt=W*Z,Bt=ce*Ae,qt=$e+tt+Bt+Le,Ht=R+Q,Ar=qt-Ht;return I.push([Ce,Me(g.customer.name),h,w,b,Le,D,Y,re,$e,W,ie,Z,tt,ce,Ie,Ae,Bt,qt,Ht,Ar]),j(Ce,{dileveryId:g.id,custId:g.customer.id,customer:g.customer.name,diaryNumber:g.customer.diaryNumber,adress:g.customer.address,deliveredBy:g.courier_boy.name,deliverBoyId:g.courier_boy.id,cash:R,online:Q,correction:g.correction,paid:g.payments.length>0,gasList:g.gas_deliveries,payments:g.payments},et,{cylinders:h,mt:w,rate:b},{cylinders:D,mt:Y,rate:re},{cylinders:W,mt:ie,rate:Z},{cylinders:ce,mt:Ie,rate:Ae},R+Q)})));const P=it.map(g=>g.column);return e.jsxs(C,{sx:{width:"100%",backgroundColor:"white",borderRadius:"lg",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"center",color:"black",flexGrow:1},children:[e.jsx(A,{sx:{width:"100%",height:"100vh",flexGrow:1,display:r?"flex":"none",justifyContent:"center",alignItems:"center"},children:e.jsx(Se,{sx:{backgroundColor:"transparent",display:r?"flex":"none"}})}),e.jsxs(C,{sx:{width:"100%",display:r?"none":"flex",overflow:"auto",flexGrow:1},direction:"row",gap:.5,mt:.5,mb:.5,pr:.5,alignContent:"end",justifyContent:"flex-end",children:[e.jsx(ul,{headers:P,data:I,filename:"deliveries_"+ys(ne)+"_TO_"+ys(z)+".csv",children:"Download File"}),e.jsx(B,{sx:{flexGrow:1,opacity:0}}),e.jsx(G,{type:"date",defaultValue:ne,onChange:g=>{X(g.target.value)}}),e.jsx(G,{type:"date",defaultValue:z,onChange:g=>{te(g.target.value)}}),e.jsx($,{sx:{borderRadius:"md"},onClick:()=>{f(!0)},children:"Load"})]}),e.jsx(C,{sx:{backgroundColor:"lightblue",width:"100%",flexGrow:1,display:r?"none":"flex"},children:e.jsx(me,{sx:{flexGrow:1},children:e.jsxs(ye,{"aria-label":"collapsible table",size:"md",sx:{wordBreak:"keep-all",tableLayout:"auto",fontWeight:"bold"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:40},"aria-label":"empty"}),it.map((g,R)=>e.jsx("th",{style:{textAlign:"center",backgroundColor:g.color},children:g.column},R+"_"+g.column))]})}),e.jsxs("tbody",{children:[U.map((g,R)=>e.jsx(yl,{row:g,initialOpen:!1,updateCustomer:Q=>{console.log(Q);const h=window.confirm("Please Confirm Change");return h&&t(Js({id:g.info.dileveryId,customer_id:Q.id})),h},deleteDelivery:()=>{const h=window.prompt(`Please Input ${g.info.dileveryId} to Delete`)==g.info.dileveryId;return h&&t(Xs(g.info.dileveryId)),h},updateGas:Q=>{console.log("updateGas : ",Q),t(uo(Q))}},g.date+"_"+R)),U.length==0?e.jsx("tr",{children:e.jsx("td",{colSpan:it.length+1,style:{textAlign:"center",fontWeight:"bold",fontSize:"1.8em"},children:"No Data"})}):null]})]})})})]})}function yl({row:t,initialOpen:s=!1,updateCustomer:r}){const[a,n]=le.useState(s),[o,i]=le.useState(!1);let m=t.subTotal-t.received;m<0&&(m=0);const S=[{key:"info",cells:[{value:t.date},{value:t.info.customer}],color:se.WHITE},{key:"kg4",cells:[{value:H(t.kg4.cylinders)},{value:H(t.kg4.mt)},{value:H(t.kg4.rate,!0)},{value:H(t.kg4.total,!0)}],color:se.KG_4},{key:"kg12",cells:[{value:H(t.kg12.cylinders)},{value:H(t.kg12.mt)},{value:H(t.kg12.rate,!0)},{value:H(t.kg12.total,!0)}],color:se.KG_12},{key:"kg15",cells:[{value:H(t.kg15.cylinders)},{value:H(t.kg15.mt)},{value:H(t.kg15.rate,!0)},{value:H(t.kg15.total,!0)}],color:se.KG_15},{key:"kg21",cells:[{value:H(t.kg21.cylinders)},{value:H(t.kg21.mt)},{value:H(t.kg21.rate,!0)},{value:H(t.kg21.total,!0)}],color:se.KG_21},{key:"summary",cells:[{value:H(t.subTotal,!0)},{value:H(t.received,!0)},{value:H(m,!0)}],color:se.WHITE}];return e.jsxs(le.Fragment,{children:[e.jsxs("tr",{style:{textAlign:"center",borderTopColor:t.info.correction==!0?"red":"",borderBottomColor:t.info.correction==!0?"red":""},children:[e.jsx("td",{style:{textAlign:"center",backgroundColor:se.WHITE,borderTopColor:t.info.correction==!0?"red":"",borderBottomColor:t.info.correction==!0?"red":""},children:e.jsx(A,{children:e.jsx(Ds,{"aria-label":"expand row",variant:"plain",color:"neutral",size:"sm",onClick:()=>n(!a),children:a?e.jsx(na,{}):e.jsx(oa,{})})})}),S.map(v=>v.cells.map((c,E)=>e.jsx("td",{style:{backgroundColor:v.color,textAlign:"center",borderTopColor:t.info.correction==!0?"red":"",borderBottomColor:t.info.correction==!0?"red":""},children:c.value},`${v.key}-${E}`)))]}),e.jsx("tr",{children:e.jsx("td",{style:{height:0,padding:0},colSpan:it.length+1,children:a&&e.jsxs(me,{variant:"soft",sx:{p:1,pl:6,boxShadow:"inset 0 3px 6px 0 rgba(0 0 0 / 0.08)",m:0},children:[e.jsx(ue,{level:"body-lg",component:"div",children:"Details"}),e.jsxs(ye,{borderAxis:"bothBetween",size:"md",stickyFooter:!1,stickyHeader:!1,stripe:"even",sx:{fontWeight:"bold",tableLayout:"auto","& thead td:nth-child(1)":{width:"256px"}},children:[e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Diary Number"}),e.jsx("td",{children:t.info.diaryNumber})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Date"}),e.jsx("td",{children:t.date})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Customer"}),e.jsx("td",{children:e.jsx(jl,{value:{cust_id:t.info.custId,name:t.info.customer},onChange:v=>r(v)})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Address"}),e.jsx("td",{children:Me(t.info.adress)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Delivered By"}),e.jsx("td",{children:Me(t.info.deliveredBy)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:H(t.info.cash)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Online"}),e.jsx("td",{children:H(t.info.online)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Correction"}),e.jsx("td",{children:t.info.correction?"Yes":"No"})]}),e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsx(bl,{selectedGasList:t.info.gasList,customer:t.info.custId,deliveryBoy:t.info.deliverBoyId,deleveryId:t.info.dileveryId,payments:t.info.payments,correction:t.info.correction,openEdit:o})})})]}),e.jsx("tbody",{})]})]})})})]})}const jl=({value:t,onChange:s})=>{const[r,a]=le.useState(t),n=Lt,o=n.find(i=>i.id===r.cust_id)||null;return e.jsx(xa,{variant:"outlined",placeholder:Me(r.name),options:n,value:o,onChange:(i,m)=>{m&&s(m)&&a({cust_id:m.id,name:m.label})},getOptionLabel:i=>i.label||"",isOptionEqualToValue:(i,m)=>i&&m&&i.id===m.id,clearOnBlur:!1,disableClearable:!0,freeSolo:!1,openOnFocus:!0,sx:{fontWeight:900,color:"black",backgroundColor:"white","& .MuiInput-root":{fontWeight:"bold"}},slotProps:{input:{sx:{fontWeight:900,color:"black"}}}},`autocomplete-${r.cust_id}`)};function ys(t){var s=new Date(t),r=String(s.getDate()).padStart(2,"0"),a=String(s.getMonth()+1).padStart(2,"0"),n=s.getFullYear(),o=n.toString().slice(2,4);return r+"/"+a+"/"+o}function wl(t){var s=new Date(t),r=String(s.getDate()).padStart(2,"0"),a=String(s.getMonth()+1).padStart(2,"0"),n=s.getFullYear(),o=n.toString().slice(2,4);let i=r+"/"+a+"/"+o,m=s.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"});return m=m.toUpperCase(),i+" - "+m}const st=t=>{const s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${s}-${r}-${a}`};function rt(t,s,r){return{cylinders:t,mt:s,rate:r,total:t*r}}const bl=({selectedGasList:t,customer:s,deliveryBoy:r,deleveryId:a,payments:n,correction:o,openEdit:i})=>{const m=pe();let S={id:null,amount:null,method:null},v={id:null,amount:null,method:null};const[c,E]=l.useState(o);n.forEach(f=>{f.method==0?v={id:f.id,amount:f.amount,method:f.method}:S={id:f.id,amount:f.amount,method:f.method}});const[_,x]=l.useState(v),[d,u]=l.useState(S),L=f=>{u({id:S.id,amount:f,method:S.method})},T=f=>{x({id:v.id,amount:f,method:v.method})};console.log(v),console.log(S);const[F,p]=l.useState(i),[k,O]=l.useState("");let y=[],N=new Map;t.forEach(f=>{N.set(f.id,f)});const[V,X]=l.useState(N),[ne,q]=l.useState(new Map),te=(f,M,j)=>{let U=new Map(V);U.set(f,{...U.get(f),[M]:j}),X(U)},z=f=>{let M=new Map(V);M.set("new_"+V.size+1,{id:"new_"+V.size+1,is_empty:!1,quantity:0,price:0,gas_id:+f}),X(M)},oe=f=>{let M=new Map(ne);M.set(f,V.get(f)),q(M);let j=new Map(V);j.delete(f),X(j)};for(const[f,M]of Ft.entries())M.company_name.toLowerCase().includes(k.toLowerCase())&&k.length>0&&y.push(e.jsx(we,{children:e.jsxs(ga,{onClick:()=>{z(M.id),O("")},children:[e.jsx(Ke,{children:e.jsx(la,{})}),e.jsxs(be,{sx:{color:"black",fontWeight:"bold"},children:[M.company_name," : ",M.kg,"kg"]}),e.jsx(Ke,{children:e.jsx(ia,{})})]})},f));return F?e.jsx(Ne,{"aria-labelledby":"modal-title","aria-describedby":"modal-desc",open:F,onClose:()=>p(!1),sx:{display:"flex",justifyContent:"center",alignItems:"flex-start",mb:10},children:e.jsx("form",{onSubmit:f=>{f.preventDefault()},children:e.jsxs(me,{variant:"outlined",sx:{borderRadius:"md",p:3,boxShadow:"lg",my:10,overflow:"auto"},children:[e.jsx(ke,{variant:"plain",sx:{m:1}}),e.jsxs(ue,{component:"h2",id:"modal-title",level:"h4",textColor:"inherit",sx:{fontWeight:"lg",mb:1},children:["Edit Delivery of ",s," by ",r]}),e.jsxs(me,{children:[e.jsxs(C,{direction:"row",gap:1,alignContent:"center",sx:{mb:1},children:[e.jsx(ge,{size:"lg",color:"success",sx:{fontWeight:"bold"},children:"Online"}),e.jsx(G,{startDecorator:e.jsx("span",{children:"₹"}),type:"number",value:d.amount===null?"":d.amount,onChange:f=>{L(f.target.value)},required:!0,sx:{maxWidth:"128px"}}),e.jsx(ge,{size:"lg",color:"warning",sx:{fontWeight:"bold"},children:"Cash"}),e.jsx(G,{startDecorator:e.jsx("span",{children:"₹"}),type:"number",value:_.amount===null?"":_.amount,onChange:f=>{T(f.target.value)},required:!0,sx:{maxWidth:"128px"}})]}),e.jsx("span",{className:"b",children:" Gas List"}),e.jsxs(We,{sx:{backgroundColor:"#FFF1DB"},children:[[...V.values()].map(f=>(console.log("nc",f.nc),e.jsx(we,{sx:{width:"100%"},children:e.jsx(be,{sx:{color:"black",fontWeight:"bold"},children:e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",children:[f.is_empty?null:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"NC"}),e.jsx(Xt,{checked:f.nc,onChange:M=>{te(f.id,"nc",M.target.checked)}})]}),e.jsxs(fa,{value:f.is_empty==!0?1:0,name:"radio-buttons-group",orientation:"horizontal",required:!0,onChange:M=>{te(f.id,"is_empty",M.target.value==1)},children:[e.jsx(Zt,{value:0,label:"Delivered",variant:"outlined",color:"success"}),e.jsx(Zt,{value:1,label:"Received",variant:"outlined",color:"danger"})]}),e.jsx(Te,{required:!0,sx:{width:"220px",ml:2},defaultValue:f.gas_id,onChange:(M,j)=>{te(f.id,"gas_id",j)},children:Ut}),e.jsx(G,{required:!0,sx:{width:"168px"},type:"number",value:f.quantity,startDecorator:e.jsx("span",{children:"Qty : "}),onChange:M=>{te(f.id,"quantity",M.target.value)}}),e.jsx(G,{required:!f.is_empty,sx:{width:"168px",visibility:f.is_empty?"hidden":"visible"},type:"number",value:f.gas_price,startDecorator:e.jsx("span",{children:"Amt : "}),onChange:M=>{te(f.id,"gas_price",M.target.value)}}),e.jsx(A,{onClick:()=>{oe(f.id)},sx:{padding:"6px",backgroundColor:"#e34a4c",color:"white",borderRadius:"16px"},children:e.jsx(at,{})})]})})},f.id))),e.jsx(we,{children:e.jsx(be,{children:e.jsx(G,{value:k,onChange:f=>{O(f.target.value)},placeholder:"Add Gas"})})})]}),e.jsx("span",{className:"b",children:" Correction"}),e.jsx(C,{direction:"row",gap:1,alignContent:"center",sx:{mb:1},children:e.jsx(Xt,{checked:c,onChange:f=>E(f.target.checked),sx:f=>({"--Switch-thumbShadow":"0 3px 7px 0 rgba(0 0 0 / 0.12)","--Switch-thumbSize":"27px","--Switch-trackWidth":"51px","--Switch-trackHeight":"31px","--Switch-trackBackground":"rgb(48 209 88)",[`& .${es.thumb}`]:{transition:"width 0.2s, left 0.2s"},"&:hover":{"--Switch-trackBackground":"rgb(48 209 88)"},"&:active":{"--Switch-thumbWidth":"32px"},[`&.${es.checked}`]:{"--Switch-trackBackground":"rgb(220 53 69)","&:hover":{"--Switch-trackBackground":"rgb(220 53 69)"}}})})})]}),e.jsx(me,{sx:{overflow:"auto",maxHeight:"90vh"},children:e.jsx(We,{children:y})}),e.jsxs(C,{direction:"row",gap:1,justifyContent:"flex-end",alignItems:"flex-end",children:[e.jsx(A,{sx:{color:"#B8001F",p:1,borderRadius:"16px","&:hover":{color:"white",backgroundColor:"#B8001F"}},onClick:()=>{const f=window.prompt(`Are you sure you want to delete this delivery? Type ${a} to confirm.`);Number(f)===Number(a)&&(console.log("Delete",a),m(Xs(a))),p(!1)},children:e.jsx(da,{})}),e.jsx(B,{orientation:"horizontal",sx:{flexGrow:1,opacity:0}}),e.jsx($,{color:"warning",variant:"outlined",onClick:()=>{p(!1)},children:"Cancel"}),e.jsx($,{type:"submit",onClick:()=>{let f=new Map(V),M=[...f.values()].filter(R=>`${R.id}`.startsWith("new_"));M.forEach((R,Q)=>{R.delivery_id=a,M[Q]=R}),f=new Map(V);let j=[...f.values()].filter(R=>!`${R.id}`.startsWith("new_"));const U=[...ne.values()].map(R=>R.id),I=M.map(R=>(delete R.id,R)),P=[{deliverie_id:a,customer_id:s,courier_boy_id:r,id:S.id,amount:d.amount,method:1},{deliverie_id:a,customer_id:s,courier_boy_id:r,id:v.id,amount:_.amount,method:0}];m(hl(P)),m(co(U)),m(lo(I)),m(Js({id:a,correction:c}));const g=j.map(R=>({id:R.id,gas_id:R.gas_id,price:R.gas_price,quantity:R.quantity,is_empty:R.is_empty,nc:R.nc}));m(io(g)),p(!1)},children:"Save"})]})]})})}):e.jsx($,{onClick:()=>{p(!0)},startDecorator:e.jsx(ca,{}),children:"Edit"})};function Sl(){const t=pe(),s=J(L=>L.loginV2),[r,a]=l.useState("");let n=sessionStorage?.getItem("authToken")!==null,o=sessionStorage?.getItem("otpToken")!==null;console.log(o,n),console.log(n);const m=new URL(window.location.href).toString(),v=(L=>L.toLowerCase().includes("/report"))(m);console.log(v);const[c,E]=l.useState(!1),_=()=>{E(!c)};s.isError&&(alert(s.errorMessage),t(mn()));let x="",d="";const u=()=>e.jsx("div",{style:{justifyContent:"center",display:"flex"},children:e.jsx(_e,{orientation:"vertical",size:"lg",variant:"outlined",sx:{mt:10},children:e.jsxs(C,{direction:"column",justifyContent:"center",alignItems:"stretch",spacing:2,children:[e.jsx(ue,{level:"title-lg",children:"Admin Login"}),e.jsxs(C,{direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e.jsx(ge,{disabled:!1,size:"lg",variant:"soft",children:"USER NAME :"}),e.jsx(G,{placeholder:"User Name",size:"lg",variant:"soft",onChange:L=>{x=L.target.value}})]}),e.jsxs(C,{direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e.jsx(ge,{disabled:!1,size:"lg",variant:"soft",children:"PASSWORD :"}),e.jsx(G,{placeholder:"Password",size:"lg",variant:"soft",onChange:L=>{d=L.target.value}})]}),e.jsx(fe,{sx:{display:s.isLoading?"block":"none"},color:"primary",variant:"soft"}),e.jsx($,{color:"primary",sx:{display:s.isLoading?"none":"block"},onClick:function(){x.trim()===""||d.trim()===""?alert("Please input username and password"):t(gn(x,d))},size:"lg",variant:"soft",children:"LOGIN"})]})})});return navigator.onLine==!1?e.jsx(A,{sx:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs(me,{sx:{display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"#FEF9F2",padding:10,borderRadius:"16px"},children:[e.jsx(ue,{level:"title-lg",sx:{fontWeight:"bold",fontSize:"16px"},children:"Shree Ram Distributer"}),e.jsx(ua,{style:{fontSize:"128px"}}),e.jsx(ue,{level:"title-lg",sx:{fontWeight:"bold",fontSize:"32px"},children:"Offline"}),e.jsx(ue,{level:"title-lg",sx:{fontWeight:"bold",fontSize:"16px"},children:"No Internet Connection..."})]})}):e.jsx(ya,{children:e.jsxs(C,{direction:"column",sx:{width:"100vw",height:"100vh"},children:[e.jsxs(C,{sx:{width:"100vw",p:1},direction:"row",alignContent:"center",justifyContent:"flex-start",alignItems:"center",children:[e.jsx(Ha,{OpenSidebar:_}),e.jsx("img",{src:"vite.svg",style:{height:"48px"},alt:"logo"}),e.jsx(ue,{level:"title-lg",sx:{fontWeight:"bold",color:"#9e9ea4"},children:"Shree Ram Distributer"})]}),n?e.jsx(Kt,{children:e.jsxs(C,{sx:{flexGrow:1,overflow:"hidden"},direction:"row",children:[e.jsx(A,{sx:{height:"100%"},children:e.jsx(qa,{openSidebarToggle:c,OpenSidebar:_})}),e.jsx(A,{sx:{flexGrow:1,overflow:"auto"},children:e.jsxs(ts,{children:[e.jsx(de,{path:"/admin/",Component:Ba}),e.jsx(de,{path:"/admin/insert",Component:Gn}),e.jsx(de,{path:"/admin/read",Component:ln}),e.jsx(de,{path:"/admin/update",Component:Pn}),e.jsx(de,{path:"/admin/addDeliveryBoy",Component:On}),e.jsx(de,{path:"/admin/readDeliveryBoy",Component:To}),e.jsx(de,{path:"/admin/updateDeliveryBoy",Component:Wn}),e.jsx(de,{path:"/admin/addWherehouse",Component:Mn}),e.jsx(de,{path:"/admin/readWherehouse",Component:An}),e.jsx(de,{path:"/admin/updateWherehouse",Component:$n}),e.jsx(de,{path:"/admin/InsertReport",Component:Bn}),e.jsx(de,{path:"/admin/readReport",Component:Ln}),e.jsx(de,{path:"/admin/readReport",Component:qn}),e.jsx(de,{path:"/admin/PrintReport",Component:Hn}),e.jsx(de,{path:"/admin/deliveryHistory",Component:fl}),e.jsx(de,{path:"/admin/ViewCustomer",Component:Co}),e.jsx(de,{path:"/admin/expence",Component:Fo}),e.jsx(de,{path:"/admin/purchase",Component:$o}),e.jsx(de,{path:"/admin/report",element:e.jsx(gs,{isLogged:!0})})]})})]})}):v?e.jsx(Kt,{children:e.jsx(C,{sx:{flexGrow:1,overflow:"hidden"},direction:"row",children:e.jsx(A,{sx:{flexGrow:1,width:"100%",height:"100%"},children:e.jsx(ts,{children:e.jsx(de,{path:"/admin/report",element:e.jsx(gs,{isLogged:!1})})})})})}):o?e.jsx(e.Fragment,{children:e.jsxs(C,{sx:{flexGrow:1,overflow:"hidden"},direction:"column",justifyContent:"flex-start",alignItems:"center",gap:1,mt:15,children:[e.jsx(G,{sx:{width:"420px"},placeholder:"OTP",size:"lg",variant:"soft",type:"number",onChange:L=>{a(L.target.value)}}),e.jsx(Se,{sx:{display:s.isLoading?"block":"none"}}),e.jsxs(C,{sx:{flexGrow:1,overflow:"hidden",display:s.isLoading?"none":"flex"},direction:"row",justifyContent:"center",alignItems:"flex-start",gap:1,children:[e.jsx($,{sx:{width:"120px"},color:"warning",variant:"soft",onClick:function(){sessionStorage.removeItem("authToken"),sessionStorage.removeItem("otpToken"),window.location.reload()},children:"Cancel"}),e.jsx($,{sx:{width:"120px"},color:"primary",variant:"soft",onClick:function(){t(fn(r))},children:"Verify OTP"})]})]})}):e.jsx(u,{})]})})}const Tt=je("delivery/fetchDeliveryHistory",async()=>{let t=!0,s=null,r="";try{const a=sessionStorage.getItem("authToken");s=await(await fetch(Aa,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420",Authorization:`Bearer ${a}`})})).json(),t=!1}catch(a){console.warn(a),t=!0,r=a.message}return{data:s,error:t,errorMessage:r}}),Cl=xe({name:"delivery",initialState:{isLoading:!1,data:null,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(Tt.pending,(s,r)=>{s.isLoading=!0}),t.addCase(Tt.fulfilled,(s,r)=>{s.isLoading=!1,s.data=r.payload.data,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage}),t.addCase(Tt.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),vl=Cl.reducer,Rt=je("login/fetchCheckLogin",async t=>{let s=!0,r="",a=!1;try{(await(await fetch(Ta,{method:"get",headers:{"ngrok-skip-browser-warning":"69420","Content-Type":"application/json",Authorization:`Bearer ${t}`}}).catch(i=>{console.warn(i),s=!0,r=i.message})).json()).status==="true"&&(a=!0),s=!1}catch(n){console.warn(n),s=!0,r=n.message}return{status:a,isError:s,errorMessage:r}}),El=xe({name:"checkLogin",initialState:{isLoading:!1,status:!1,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(Rt.pending,(s,r)=>{s.isLoading=!0}),t.addCase(Rt.fulfilled,(s,r)=>{s.isLoading=!1,s.status=r.payload.status,s.isError=r.payload.isError,s.errorMessage=r.payload.errorMessage}),t.addCase(Rt.rejected,(s,r)=>{s.isLoading=!1,s.isError=!0})}}),_l=El.reducer,js=je("gasDeliverys/gasDeliverys",async t=>{let s=!1,r=!0,a="";try{const n=sessionStorage.getItem("authToken");if(t.opration=="insert"){const i=await(await fetch(Fa,{method:"post",headers:new Headers({"Content-Type":"application/json",Authorization:`Bearer ${n}`}),body:JSON.stringify(t)})).json();console.log(i),s=i.isSuccessFull,r=!1}if(t.opration=="delete"){const i=await(await fetch(La+t.id,{method:"delete",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${n}`})})).json();console.log(i),s=i.isSuccessFull,r=!1}}catch(n){console.warn(n),r=!0,a=n.message}return{isSuccessful:s,error:r,errorMessage:a}}),Dl=xe({name:"gasDeliverys",initialState:{isSuccessful:!1,isLoading:!1,isError:!1,errorMessage:""},extraReducers:t=>{t.addCase(js.pending,(s,r)=>{s.isLoading=!0}),t.addCase(js.fulfilled,(s,r)=>{s.isLoading=!1,s.isSuccessful=r.payload.isSuccessful,s.isError=r.payload.error,s.errorMessage=r.payload.errorMessage})}}),Nl=Dl.reducer,ws={loading:!1,orders:[],error:null,updateOrderSuccsess:!1},kl=(t=ws,s)=>{switch(s.type){case Ws:return ws;case ze:return{...t,loading:!0};case Us:return{...t,loading:!1,orders:s.payload};case Ye:return{...t,loading:!1,error:s.error};case Gs:return{...t,orders:[s.payload,...t.orders],loading:!1};case Ps:return{...t,loading:!1,updateOrderSuccsess:!0};case Os:return{...t,orders:t.orders.filter(r=>r.id!==s.payload),loading:!1};default:return t}},bs={itemLoading:!1,items:[],itemError:null,itemUpdateSuccess:!1},Tl=(t=bs,s)=>{switch(s.type){case Sr:return bs;case gt:return{...t,itemLoading:!0};case Go:return{...t,itemLoading:!1,items:s.payload};case yr:return{...t,itemLoading:!1,itemError:s.itemError};case jr:return{...t,itemLoading:!1,itemError:null,itemUpdateSuccess:!0};case wr:return{...t,items:s.payload,itemLoading:!1,itemError:null,itemUpdateSuccess:!0};case br:return{...t,itemLoading:!1,itemError:null,itemUpdateSuccess:!0};default:return t}},Rl={loading:!1,warehouses:[],error:null},Il=(t=Rl,s)=>{switch(s.type){case Ms:case Sn:case En:case Nn:return{...t,loading:!0};case $s:return{...t,loading:!1,warehouses:s.payload};case Cn:return{...t,loading:!1,warehouses:[...t.warehouses,s.payload]};case _n:return{...t,loading:!1,warehouses:t.warehouses.map(r=>r.id===s.payload.id?s.payload:r)};case kn:return{...t,loading:!1,warehouses:t.warehouses.filter(r=>r.id!==s.payload)};case Bs:case vn:case Dn:case Tn:return{...t,loading:!1,error:s.error};default:return t}},Al={plants:[],plantsLoading:!1,plantsError:null,plantsUpdateSuccess:!1},Ll=(t=Al,s)=>{switch(s.type){case un:return{state:t};case cn:return{...t,plantsLoading:!0,plantsError:null};case As:return{...t,plants:s.payload,plantsLoading:!1,plantsError:null};case Ls:return{...t,plantsLoading:!1,plantsError:s.error,plantsUpdateSuccess:!1};default:return t}},Fl={loading:!1,deliveries:null,error:!1,updateSuccess:!1},Ul=(t=Fl,s)=>{switch(s.type){case Kn:return{loading:!1,deliveries:null,error:!1,updateSuccess:!1};case Mt:return{...t,loading:!0,updateSuccess:!1,error:!1};case Hs:return{loading:!1,deliveries:s.payload,error:!1,updateSuccess:!1};case Vs:return{...t,updateSuccess:!1};case Ks:return{loading:!1,deliveries:null,error:!0,updateSuccess:!1};case Qs:return{...t,loading:!1,updateSuccess:!0,error:!1};case zs:return{...t,loading:!0,updateSuccess:!1,error:!1};case Ys:{console.log("deleteDeliverySuccess : ",s.payload),console.log("state : ",t);const r=s.payload;return{deliveries:t.deliveries?t.deliveries.filter(a=>a.id!==r):null,loading:!1,updateSuccess:!0,error:!1}}default:return t}},Gl={userDataLoading:!1,users:null,userDataError:!1},Pl=(t=Gl,s)=>{switch(s.type){case Zs:return{...t,userDataLoading:!0,userDataError:!1};case er:return{userDataLoading:!1,users:s.payload,userDataError:!1};case tr:return{userDataLoading:!1,users:null,userDataError:!0};default:return t}},Ol={gasDeliverysSucsess:!1,loading:!1,error:null},Wl=(t=Ol,s)=>{switch(s.type){case no:return{gasDeliverysSucsess:!1,loading:!1,error:null};case Ze:return{...t,loading:!0};case oo:return{...t,gasDeliverysSucsess:!0,loading:!1};case sr:return{...t,gasDeliverysSucsess:!0,loading:!1};case rr:return{...t,gasDeliverysSucsess:!0,loading:!1};case ar:return{...t,gasDeliverysSucsess:!0,loading:!1};case Xe:return{...t,error:s.payload,loading:!1,gasDeliverysSucsess:!1};case nr:return{...t,gasDeliverysSucsess:!0,loading:!1};case or:return{...t,gasDeliverysSucsess:!1,loading:!1};default:return t}},Ml={expenceLoading:!1,expenses:[],expenceError:!1},$l=(t=Ml,s)=>{switch(s.type){case Ao:return{expenceLoading:!1,expenses:[],expenceError:!1};case hr:return{...t,expenceLoading:!0,expenceErroxr:!1};case mr:return{expenceLoading:!1,expenses:s.payload,expenceError:!1};case pr:return{expenceLoading:!1,expenses:[],expenceError:!0};default:return t}},Bl={gasLoading:!1,gasList:[],gasError:!1},ql=(t=Bl,s)=>{switch(s.type){case lr:return{...t,gasLoading:!0,gasError:!1};case ir:return{gasLoading:!1,gasList:s.payload,gasError:!1};case cr:return{gasLoading:!1,gasList:[],gasError:!0};case po:return{gasLoading:!1,gasList:[],gasError:!1};default:return t}},Hl={customersLoading:!1,customers:[],customersError:!1},Kl=(t=Hl,s)=>{switch(s.type){case Ho:return{customersLoading:!1,customers:[],customersError:!1};case Cr:return{...t,customersLoading:!0,customersError:!1};case vr:return{customersLoading:!1,customers:s.payload,customersError:!1};case Er:return{customersLoading:!1,customers:[],customersError:!0};default:return t}},Ql={reportLoading:!1,report:null,reportError:!1},Vl=(t=Ql,s)=>{switch(s.type){case Jo:return console.log("report init state"),{reportLoading:!1,report:null,reportError:!1};case _r:return console.log("report request"),{...t,reportLoading:!0,reportError:!1};case Dr:return console.log("report : ",s.payload),{reportLoading:!1,report:s.payload,reportError:!1};case Nr:return console.log("report error : ",s.payload),{reportLoading:!1,report:null,reportError:!0};default:return t}},zl=ma({reducer:{login:No,loginV2:yn,checkLogin:_l,delivery:vl,deliverys:Ul,count:$a,gas:Qa,gasList:ql,search_customer:za,customers:mo,customer:Kl,updateDeliveryData:Za,updateGas:Ja,updateCustomer:on,getData:tn,gasDeliverys:Nl,gasDelivery:Wl,purchaseOrders:kl,purchaseOrderItems:Tl,reports:Vl,plants:Ll,warehouses:Il,user:Pl,expence:$l,connections:So,bill:ll,customerPaymentsUpdateOrCreate:gl},devTools:!1});Lr.createRoot(document.getElementById("root")).render(e.jsx(le.Fragment,{children:e.jsx(ha,{store:zl,children:e.jsx(Sl,{})})}));
